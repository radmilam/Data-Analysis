<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Smoothing</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Smoothing</h1>

<p>Key idea</p>

<ul>
<li>Sometimes there are non-linear trends in data</li>
<li>We can use &ldquo;smoothing&rdquo; to try to capture these</li>
<li>Still a risk of overfitting</li>
<li>Often hard to interpret</li>
</ul>

<h2>CD4 Data</h2>

<pre><code class="r">if (!file.exists()) {
    download.file(&quot;http://spark-public.s3.amazonaws.com/dataanalysis/cd4.data&quot;, 
        destfile = &quot;./data/cd4.data&quot;)
}
</code></pre>

<pre><code>## Error: invalid &#39;file&#39; argument
</code></pre>

<pre><code class="r">cd4Data &lt;- read.table(&quot;./data/cd4.data&quot;, col.names = c(&quot;time&quot;, &quot;cd4&quot;, &quot;age&quot;, 
    &quot;packs&quot;, &quot;drugs&quot;, &quot;sex&quot;, &quot;cesd&quot;, &quot;id&quot;))
cd4Data &lt;- cd4Data[order(cd4Data$time), ]
head(cd4Data)
</code></pre>

<pre><code>##        time  cd4   age packs drugs sex cesd    id
## 1279 -2.990  814  6.17     3     1   5   -3 30183
## 2190 -2.990  400 -6.02     0     0   3   -4 41406
## 1167 -2.984  467 13.94     0     1   1    0 30046
## 1427 -2.957  749 -4.54     0     1  -1   -7 30498
## 2032 -2.951 1218  5.57     3     1   5    3 41032
## 1813 -2.949 1015 -9.15     2     1   0   -7 40375
</code></pre>

<p><a href="http://www.cbcb.umd.edu/%7Ehcorrada/PracticalML/">http://www.cbcb.umd.edu/~hcorrada/PracticalML/</a></p>

<h2>CD4 over time</h2>

<p>There&#39;s some kind of pattern</p>

<pre><code class="r">plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAe1BMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBltdpltf2POQCPOTmPOWWPZo+Pj2WP29qP2/21ZgC124+1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v2Py/6oAAAAKXRSTlP/////////////////////////////////////////////////////AFL0IIcAAAAJcEhZcwAACxIAAAsSAdLdfvwAAB0iSURBVHic7Z0Le9s2soaXyW7ddlM7PSdOs7E33j2xbP3/X3hESSQBzAWDGwlx5ntaRyLAAcgXmBmQlPS3o0ml/rZ1B0zbyMArlYFXKgOvVAZeqQy8Uhl4pTLwSmXglcrAK5WBVyoDr1QGXqkMvFIZeKUy8Epl4JXKwCuVgVcqA69UBl6pDLxSGXilMvBKZeCVysArlYFXKgOvVAZeqQy8Uhl4pTLwSmXglcrAK5WBVyoDr1QGXqkMvFIZeKUy8Epl4JXKwCuVgVcqA69UBl6pDLxSGXilMvBKZeCVysArlYFXKgOvVAZeqQy8Uhl4pTLwSmXglcrAK1UJ+MHUsxqCL9jX1FoGXqkMvFIZeKUy8Epl4JXKwCuVgVcqA69UBl6pDLxS6QAfuzKtUAZeqXSANwEZeKUy8Epl4JXKwCuVgVeqYvCHX89PcH38kWratKlKwb8/fjn/+/rLz0TTpk1VCv7tzx/ev3LTpk1lM16pimP824PF+FuUZfVKZeCVypZzSmXJnVLZck6pbMYrlerlnOYHc1Rn9QaeVA544UfvTZvKlnNKZcmdUtlyTqlsxiuV6uWcZqlezmmWgVeqGsu5+2dz9TenGsnd84n64ZMldzelGsu513tbzt2cai3nbMbfmCos50byLxbjb0yW1SuVgVcqA69UBl6pDLxSGXilMvBKZeCVysArlYFXKgOvVAZeqQy8Uhl4pTLwSmXglcrAK5WBVyoDr1RawNun9QMZeKXSAt4UyMArlYFXKgOvVHsBb8lbogy8UvUKPg+k4Rer1++5M/CNZd96pVT2PXdKZTNeqex77pSq16ze1FgGXql6Xc6ZGutmkjtbotfV9ss5IVEDX1fbz3gjuolsOadU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" alt="plot of chunk unnamed-chunk-2"/> </p>

<h2>Average first 2 points</h2>

<p>Running average - take first 2 data points, take their average and plot it vs. the average time point of the first two time points.</p>

<pre><code class="r">plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
points(mean(cd4Data$time[1:2]), mean(cd4Data$cd4[1:2]), col = &quot;blue&quot;, pch = 19)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-3"/> </p>

<h2>Average second and third points</h2>

<pre><code class="r">plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
points(mean(cd4Data$time[1:2]), mean(cd4Data$cd4[1:2]), col = &quot;blue&quot;, pch = 19)
points(mean(cd4Data$time[2:3]), mean(cd4Data$cd4[2:3]), col = &quot;blue&quot;, pch = 19)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-4"/> </p>

<h2>A moving average</h2>

<pre><code class="r">plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
aveTime &lt;- aveCd4 &lt;- rep(NA, length(3:(dim(cd4Data)[1] - 2)))
for (i in 3:(dim(cd4Data)[1] - 2)) {
    aveTime[i] &lt;- mean(cd4Data$time[(i - 2):(i + 2)])
    aveCd4[i] &lt;- mean(cd4Data$cd4[(i - 2):(i + 2)])
}
lines(aveTime, aveCd4, col = &quot;blue&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> </p>

<p>For each data value, We average the time points before to two time ponits after the time point in question.</p>

<h2>Average more points</h2>

<p>10 points before and after.</p>

<pre><code class="r">plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
aveTime &lt;- aveCd4 &lt;- rep(NA, length(11:(dim(cd4Data)[1] - 10)))
for (i in 11:(dim(cd4Data)[1] - 2)) {
    aveTime[i] &lt;- mean(cd4Data$time[(i - 10):(i + 10)])
    aveCd4[i] &lt;- mean(cd4Data$cd4[(i - 10):(i + 10)])
}
lines(aveTime, aveCd4, col = &quot;blue&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAflBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBltdpltf2POQCPOTmPOWWPZo+Pj2WP29qP2/21ZgC124+1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v2Jj6rIAAAAKnRSTlP//////////////////////////////////////////////////////wAyqPBcAAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nO2dC5vkpo6GDxPvppPspGeyO5NkM32mz9n0xf//D275AggkYbDBdln6nmS6CjDGfkES+FL/6FUi9Y+jG6A6RgpeqBS8UCl4oVLwQqXghUrBC5WCFyoFL1QKXqgUvFApeKFS8EKl4IVKwQuVghcqBS9UCl6oFLxQKXihUvBCpeCFSsELlYIXKgUvVApeqBS8UCl4oVLwQqXghUrBC5WCFyoFL1QKXqgUvFApeKFS8EKl4IVKwQuVghcqBS9UCl6oFLxQKXihUvBCpeCFSsELlYIXKgUvVApeqBS8UCl4oVLwQqXghUrBC5WCFyoFL1QKXqi2gDeqM6sh+A3bqlpLwQuVghcqBS9UCl6oFLxQKXihUvBCpeCFSsELlYIXKhngl1amBUrBC5UM8CokBS9UCl6oFLxQKXihUvBCtRn860/jHVw/fC+tWnWotoJ///pl/Pvy49+FVasO1Vbwb799D/7mV606VDrihWqzj3/7pD7+HqVRvVApeKHS6ZxQaXAnVDqdEyod8UIlejon+cYc0VG9gme1Bnzmo/eqQ6XTOaHS4E6odDonVDrihUr0dE6yRE/nJEvBC1WN6dzjk5r6u1ON4O7pRv31owZ3d6Ua07mXR53O3Z1qTed0xN+ZKkznBvLP6uPvTBrVC5WCFyoFL1QKXqgUvFApeKFS8EKl4IVKwQuVghcqBS9UCl6oFLxQKXihUvBCpeCFSsELlYIXKgUvVFLA69P6kRS8UEkBr4qk4IVKwQuVgheqq4DX4K1QCl6ozgp+HUjFn62zvudOwTeWvvVKqPQ9d0KlI16o9D13QnXWqF7VWApeqM46nVM11t0EdzpFr6vjp3OZRBV8XR0/4pXo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" alt="plot of chunk unnamed-chunk-6"/> </p>

<h2>Average many more</h2>

<pre><code class="r">plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
aveTime &lt;- aveCd4 &lt;- rep(NA, length(201:(dim(cd4Data)[1] - 200)))
for (i in 201:(dim(cd4Data)[1] - 2)) {
    aveTime[i] &lt;- mean(cd4Data$time[(i - 200):(i + 200)])
    aveCd4[i] &lt;- mean(cd4Data$cd4[(i - 200):(i + 200)])
}
lines(aveTime, aveCd4, col = &quot;blue&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<h2>A faster way</h2>

<p>Using the <code>filter</code> function.</p>

<pre><code class="r">filtTime &lt;- as.vector(filter(cd4Data$time, filter = rep(1, 200))/200)
filtCd4 &lt;- as.vector(filter(cd4Data$cd4, filter = rep(1, 200))/200)
plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
lines(filtTime, filtCd4, col = &quot;blue&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-8"/> </p>

<h2>Averaging = weighted sums</h2>

<p>It&#39;s what the filter function does.</p>

<pre><code class="r">filtCd4 &lt;- as.vector(filter(cd4Data$cd4, filter = rep(1, 4))/4)
filtCd4[2]
</code></pre>

<pre><code>## [1] 607.5
</code></pre>

<pre><code class="r">sum(cd4Data$cd4[1:4] * rep(1/4, 4))
</code></pre>

<pre><code>## [1] 607.5
</code></pre>

<h2>Other weights -&gt; should sum to one</h2>

<p>Disadvantage is that sometimes you might thing that the two values that are very close to each other should contribut a lot of weight to the moving average, but values that are farther apart should contribute less.</p>

<pre><code class="r">ws = 10
tukey = function(x) pmax(1 - x^2, 0)^2
filt = tukey(seq(-ws, ws)/(ws + 1))
filt = filt/sum(filt)
plot(seq(-(ws), (ws)), filt, pch = 19)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-10"/> </p>

<p>Created <strong>tuke weights</strong>, ws = weights. We want the set of weights to sum to 1, hence the value of <code>filt</code> argument. Gives good estimate of the function. [7.49] It average points closer to center with higher weights and points farther from center with lower weights.</p>

<pre><code class="r">ws = 100
tukey = function(x) pmax(1 - x^2, 0)^2
filt = tukey(seq(-ws, ws)/(ws + 1))
filt = filt/sum(filt)
filtTime &lt;- as.vector(filter(cd4Data$time, filter = filt))
filtCd4 &lt;- as.vector(filter(cd4Data$cd4, filter = filt))
plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
lines(filtTime, filtCd4, col = &quot;blue&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAflBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBltdpltf2POQCPOTmPOWWPZo+Pj2WP29qP2/21ZgC124+1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v2Jj6rIAAAAKnRSTlP//////////////////////////////////////////////////////wAyqPBcAAAACXBIWXMAAAsSAAALEgHS3X78AAAdzElEQVR4nO2dC5vbto6GD5PsdtpuOpPuJmm2mZM5ZzMX//8/uJatC4kbQYmUZAHf005skQIpvSQASrL9j5PLpP6xdQdc28jBG5WDNyoHb1QO3qgcvFE5eKNy8Ebl4I3KwRuVgzcqB29UDt6oHLxROXijcvBG5eCNysEblYM3KgdvVA7eqBy8UTl4o3LwRuXgjcrBG5WDNyoHb1QO3qgcvFE5eKNy8Ebl4I3KwRuVgzcqB29UDt6oHLxROXijcvBG5eCNysEblYM3KgdvVA7eqBy8UTl4o3LwRuXgjcrBG5WDNyoHb1QO3qgcvFE5eKNy8Ebl4I3KwRvVEvDBtWc1BL9gX1drOXijcvBG5eCNysEblYM3KgdvVA7eqBy8UTl4o3LwRmUDfO7KtEE5eKOyAd6F5OCNysEblYM3KgdvVA7eqBaDf/n18gTX+x+lpl2bain4ty+fL/8+//Kz0LRrUy0F//rnj+RfvWnXpvIZb1SLY/zrg8f4W5Rn9Ubl4I3Kl3NG5cmdUflyzqh8xhuV6eWc5QdzTGf1Dp7VHPDKj967NpUv54zKkzuj8uWcUfmMNyrTyznLMr2csywHb1Q1lnP3j+7qb041krvHM/WXj57c3ZRqLOee7305d3OqtZzzGX9jqrCc68g/eYy/MXlWb1QO3qgcvFE5eKNy8Ebl4I3KwRuVgzcqB29UDt6oHLxROXijcvBG5eCNysEblYM3KgdvVA7eqBy8UVkB75/WB3LwRmUFvAvIwRuVgzcqB29URwHvyVuhHLxR7RX8PJCOX629fs+dg28s/9Yro/LvuTMqn/FG5d9zZ1R7zepdjeXgjWqvyzlXY91McudL9LrafjmnJOrg62r7Ge9E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" alt="plot of chunk unnamed-chunk-11"/> </p>

<h2>Lowess (loess) - Localy weighted scatter plot smoothing</h2>

<p>loess is a slight generalization of lowess</p>

<pre><code class="r">lw1 &lt;- loess(cd4 ~ time, data = cd4Data)
plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
lines(cd4Data$time, lw1$fitted, col = &quot;blue&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-12"/> </p>

<h2>Span</h2>

<p>If you don&#39;t want to rely on default decisions in loess. <code>span</code> relates to the number of points that are used when smoothing. As <code>span</code> increases, the line becomes more smooth.</p>

<pre><code class="r">plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1, ylim = c(500, 1500))
lines(cd4Data$time, loess(cd4 ~ time, data = cd4Data, span = 0.1)$fitted, col = &quot;blue&quot;, 
    lwd = 3)
lines(cd4Data$time, loess(cd4 ~ time, data = cd4Data, span = 0.25)$fitted, col = &quot;red&quot;, 
    lwd = 3)
lines(cd4Data$time, loess(cd4 ~ time, data = cd4Data, span = 0.76)$fitted, col = &quot;green&quot;, 
    lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-13"/> </p>

<h2>Predicting with loess</h2>

<pre><code class="r">tme &lt;- seq(-2, 5, length = 100)
pred1 = predict(lw1, newdata = data.frame(time = tme), se = TRUE)
plot(tme, pred1$fit, col = &quot;blue&quot;, lwd = 3, type = &quot;l&quot;, ylim = c(0, 2500))
points(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
lines(tme, pred1$fit + 1.96 * pred1$se.fit, col = &quot;red&quot;, lwd = 3)
lines(tme, pred1$fit - 1.96 * pred1$se.fit, col = &quot;red&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/> </p>

<p><code>pred1</code> uses the loess object from previous section, <code>lw1</code> and calculates standard error, <code>se</code>. We calculate prediction intervals with <code>lines</code>. <code>se.fit</code> is the standard error of the fit. </p>

<h2>Splines</h2>

<p>Easier to use when you want to adjust for more than one covariant in the model.
\[ Y_i=b_0+\sum\limits_{k=1}^K b_ks_k(x_i)+e_i
 \]</p>

<p>\( Y_i \) - outcome for ith observation
\( b_0 \) - Intercept term
\( b_k \) - Coefficient for kth spline function
\( s_k \) - kth spline function
\( x_i \) - covariate for ith observation
\( e_i \) - everything we didn&#39;t measure/model</p>

<h2>Splines in R</h2>

<p>Natural cubic splines. <code>df</code> - degrees of freedom is the number of functions that are going to be applied to the time variable. The result will be a matrix where each column is equal to one of the functions.</p>

<pre><code class="r">library(splines)
</code></pre>

<pre><code class="r">ns1 &lt;- ns(cd4Data$time, df = 3)
par(mfrow = c(1, 3))
plot(cd4Data$time, ns1[, 1])
plot(cd4Data$time, ns1[, 2])
plot(cd4Data$time, ns1[, 3])
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-16"/> </p>

<p>For each time, say 0, the point is the value of the function at time 0 times its coefficient + next + next + the intercept term, that will give the new fitted value..</p>

<h2>Regression with splines</h2>

<pre><code class="r">lm1 &lt;- lm(cd4Data$cd4 ~ ns1)
summary(lm1)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = cd4Data$cd4 ~ ns1)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -780.0 -242.4  -61.3  169.5 2263.7 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    982.0       33.9   29.01  &lt; 2e-16 ***
## ns11          -611.3       32.6  -18.78  &lt; 2e-16 ***
## ns12          -373.7       79.4   -4.71  2.6e-06 ***
## ns13          -374.8       41.2   -9.09  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Residual standard error: 357 on 2372 degrees of freedom
## Multiple R-squared: 0.203,   Adjusted R-squared: 0.202 
## F-statistic:  202 on 3 and 2372 DF,  p-value: &lt;2e-16
</code></pre>

<p>We get an intercept and estimates for each coefficient for each of the 3 spline functions. Interpreting the values is not necessarily recommented.</p>

<h2>Fitted values</h2>

<p>The degrees of freedom is about equal to the polynomial that you would use to fit the data. You can include other variables for lm, but they&#39;ll end up getting smoothed too.</p>

<pre><code class="r">plot(cd4Data$time, cd4Data$cd4, pch = 19, cex = 0.1)
points(cd4Data$time, lm1$fitted, col = &quot;blue&quot;, pch = 19, cex = 0.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-18"/> </p>

<h2>Notes and further resources</h2>

<ul>
<li>Cross-validation with splines/smoothing is a good idea</li>
<li>Do not predict outside the range of observed data</li>
<li><a href="http://www.cbcb.umd.edu/%7Ehcorrada/PracticalML/pdf/lectures/smoothing.pdf">ector Corrada Bravo&#39;s Lecture Notes</a></li>
<li><a href="http://www.biostat.jhsph.edu/%7Eririzarr/Teaching/649/section-06.pdf">Rafa Irizarry&#39;s Lecture Notes on smoothing, On splines</a></li>
<li><a href="http://www-stat.stanford.edu/%7Etibs/ElemStatLearn/">Elements of Statistical Learning</a></li>
<li><a href="http://www.stat.cmu.edu/%7Ecshalizi/ADAfaEPoV/ADAfaEPoV.pdf">Advanced Data Analysis from An Elementary Point of View</a></li>
</ul>

<h1>The bootstrap</h1>

<p>Key ideas</p>

<ul>
<li>Treat the sample as if it were the population</li>
</ul>

<p>What it is good for:</p>

<ul>
<li>Calculating standard errors</li>
<li>Forming confidence intervals</li>
<li>Performing hypothesis tests</li>
<li>Improving predictors</li>
</ul>

<h2>The &ldquo;Central Dogma&rdquo; of statistics</h2>

<p>We have a population, we take many samples and treat them as population. If we want to estimate mean, \( \Theta \).
\[ \Theta=t(F)
 \]
Sample 1:
\[ \hat{\Theta}^1=f(\hat{F}_n^1)
 \]
Sample \( \infty \)
\[ \hat{\Theta}^\infty=f(\hat{F}_n^\infty)
 \]</p>

<p><a href="http://www.gs.washington.edu/academics/courses/akey/56008/lecture/lecture5.pdf">http://www.gs.washington.edu/academics/courses/akey/56008/lecture/lecture5.pdf</a></p>

<h2>Example</h2>

<pre><code class="r">set.seed(333)
x &lt;- rnorm(30)
bootMean &lt;- rep(NA, 1000)
sampledMean &lt;- rep(NA, 1000)
for (i in 1:1000) {
    bootMean[i] &lt;- mean(sample(x, replace = TRUE))
}
for (i in 1:1000) {
    sampledMean[i] &lt;- mean(rnorm(30))
}
plot(density(bootMean))
lines(density(sampledMean), col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAsVBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVlj49ltbVltdpltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/21ZgC1Zjm1tWW124+1/rW1/tq1/v2+vr7ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AAAl9jc7AAAAO3RSTlP///////////////////////////////////////////////////////////////////////////8A/x/iKeEAAAAJcEhZcwAACxIAAAsSAdLdfvwAABN1SURBVHic7Z0Lm+O0FYarGRgStt3ShF3aQidQKJPCdhro5OL5/z+slmzHdix75Iukc3S+94FNxrEu1psjyY6V/CEDIvlD7AqAOEC8UCBeKBAvFIgXCsQLBeKFAvFCgXihQLxQIF4oEC8UiBcKxAsF4oUC8UKBeKFAvFAgXigQLxSIFwrECwXihQLxQoF4oTARf94+vAy9ev+cZfvHN5Kd1uruaSDtoftqxWWn9+ohT3zZKbXRWSg1VNHTetP/YliSEG/Yq7fE2/YoxJtXzttVb+ZD4nXiy+7uj3lR2v9gRfcD75+wMBCvW/M7YzCPJ20ot/CLUroJ8xjWj7m8/+Q7qS+0nqPaWJPpv3Mrx/zfPLKNSf2+qNKu8t0e8wzvn/MdzRtEJysKrIo0TvXmTXZ9YrJd5eL/ZjL887pR0awurKxwVbn40BdvWtY0+t482VRbVnk7F69c5Wl3+6LD7iQrxP9eJumKz909mfA9qiLy2+Lbua2y6slV/E/rx9zrt+tGRc/XwqpEDj1XIOiL10GYS3h4Oa1NZ2pCcpO3cbkla3TXp/Wq6pS7ya5dvd69Kb54pXBy3n62tnTHpsjz9u7ptM7fHq0nVVf/r+0mO9z/um6WeC2srPDwXCEo9MUfq0g5FhF492Ris5Cmqq7+uWz/PKRXPclK8TqRTXz5LjqqaiZw09U/N7qDQ+NJJf5p//C/3cNv62aJ18LKCmdFt0IBnuJLaWaMzzfUE7RD3uNuepKVepUaFH9Q1TA8Vvzh/tN2c2qK7xSW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" alt="plot of chunk unnamed-chunk-19"/> </p>

<h2>Example with boot package</h2>

<pre><code class="r">set.seed(333)
x &lt;- rnorm(30)
sampledMean &lt;- rep(NA, 1000)
for (i in 1:1000) {
    sampledMean[i] &lt;- mean(rnorm(30))
}
meanFunc &lt;- function(x, i) {
    mean(x[i])
}
bootMean &lt;- boot(x, meanFunc, 1000)
bootMean
</code></pre>

<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = meanFunc, R = 1000)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1* -0.01942 0.0006377       0.175
</code></pre>

<h2>Plotting boot package example</h2>

<pre><code class="r">plot(density(bootMean$t))
lines(density(sampledMean), col = &quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAtFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVlj49ltbVltdpltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/21ZgC1Zjm1jzm1tWW124+1/rW1/tq1/v2+vr7ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AAALRQMHAAAAPHRSTlP/////////////////////////////////////////////////////////////////////////////AP8FrvlYAAAACXBIWXMAAAsSAAALEgHS3X78AAAUhElEQVR4nO2di5rrNhVG8ZwyJBwYStLTAi2TFkonQMs0hcnF8/7vhSXbsR1fIlu3vbX/9UGTybGuK1uSHSv5VQ5E8qvYFQBxgHihQLxQIF4oEC8UiBcKxAsF4oUC8UKBeKFAvFAgXigQLxSIFwrECwXihQLxQoF4oUC8UCBeKBAvFIgXCsQLBeKFAvHBOGxi16ANefHn7ePb1L9+eM3z/fOdZKd19vAykfbQ/9eay04dNUKR+LLLMmX0kGVTFS1Kqw4o0pzW8d8DzMVr9tk98UNHlOL1v5y3q9HMp8SrxJfdw++KopT/6XdoVrCqqrKfeDMFgrR41ZvfaINFPKkOKyz8O8tUrxUxrB4Lef8pDsp+o/Qcs81gMvV3YeVY/LeIbG1SvS/qtKviMBWFH16LA/UbRCUrC6yL1E7Vy5v8+kRnuyrE/1ln+Id1q6J5U1hZ4WP2+K8/XgusaxoRyuJ1z+pO3+snm/qVVRVALXnK3b4csHvJSvH/rZL0xRfuXnQoHrMy8rviu7npoM3KZFXi79fPhcqv162Knq+FVYlO68d/barcVibDmG8oi1dBWEh4fDut9WCqQ3Kjgqd8JW8N16f1qh6U+8muQ706vC2+/JdSw3n72XpgBNZFnrcPL6d18fboPKmH+n9sN/nhw4/rdonXwqoK67eECvN9NXLFHuspi9cBqKwcywh8eNGxWUrL6qH+ter/IqRXI8kq8SrRkPjqXXTM6pXAzVD/2hoODq0ntfiX/eP/do+/rNslXgurKpzX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" alt="plot of chunk unnamed-chunk-21"/> </p>

<h2>Nuclear cost</h2>

<pre><code class="r">library(boot)
</code></pre>

<pre><code class="r">data(nuclear)
nuke.lm &lt;- lm(log(cost) ~ date, data = nuclear)
plot(nuclear$date, log(nuclear$cost), pch = 19)
abline(nuke.lm, col = &quot;red&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAkFBMVEX9/v0AAAAAADkAAGUAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j7U5j9plAABlADllAGVlOQBlOY9lZrVltdpltf2POQCPOTmPOWWPZgCPZo+PtY+P29qP2/21ZgC1ZmW124+1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AAAVM/9AAAAAMHRSTlP/////////////////////////////////////////////////////////////AP/cg8KHAAAACXBIWXMAAAsSAAALEgHS3X78AAAN60lEQVR4nO3dC1/b1gGG8ZoMSEY3nLSbSZcFtw3N8EX+/t9uupkYLNvnSOf+Ps8vy1IMEuEf6RzJkv1TRZL9FPsboDgBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEv2hT4GaWcR/gJX0u+A1404EUDXjTgRQNeNOBFA1404EUDXjTgLbp4ojOjgDfP4BR3PgFvHvBOFp1fwDtZdIYV5A68asCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8Zrvd+ceBL7LdDnjFdsAr1rLvGOPF2vWbO/BS7fbuwEu1+zG6A6/T7nBSB7xKu9dzeeA12r1xB16jt+zAS3TMDrxAQ+zAF9/R4N4HfNmdYAe+7E6yA19yZ9iBL7dTg3sf8IV2nh34QrvEDnyRXWYHvsAuDO59wJeWETvwpWXIDnxZGbMDX1Jmg3sf8MVkww58MdmxA++2aK9rbssOvNNivZOB1eDeB7zD4sCPYQfeaVHgR7ED77bw7iPZgc87mxM2b/5NAp9vNoP70ShUMHxJ7xk1lNVeXgi+qHeJO85ycAe+jEacsJEZ4wuGH3fk/rqp8JtP36rNfDa7frZdtPcKd5+4EAfwjX21/tl20TQuJ+xO4Nd3z92Wb7doGpMjdgfw86uvvzVb/N3Rvh5457kY3PumT+62D7ObavXuaIMH3nnu2Eue1ReX5RU2F6a2wGfS1BM2R59w/uuN4Q8md7N9pl9LF7Me3IPB2y+azBt1og743Bt3hY3vMX59u6jn9RHO3KmMJS6n8gdNhd8+LKrlIsJxvMgswuGR++scnLnbfn6McOZOA94Xu4Ndfb25r+6ranVju+iJKcD7Y3cxuVu2BMfujPET88me8ay+9C3e2+DeB3yaeWYHPs28s2cMX/AYH4A9Z/hS8z249wGfWGHYgfeb9XAUih14r9lOQMOxA+81O/hAg3sf8B6zgg/KDrzfzN0DswOfRsHZgU+hsIN7H/DR69hDn4cEPnJ7duCl2u/kwz/xAHzEogzufcDHKyI78PGKyg58rCKzAx+nmIN7H/ARis8OfIRSYAc+eGmwAx+4BAb3PuBDlgw78CFLiB34cCXFDnxTiGdI0hnc+4APcjNWauzAVyHg02MHvvIPnyI78E1e3ZMb3PuA91ui7MD7LVl24H2WMDvw/kp1cO8D3k+JswPvqdTZgfdS+uzAeygHduCdl/zg3ge82zJhB95t2bAD77KM2IF3Vy6Dex/wjsqLHXhH5cYOvJPyYwfeQZkN7n3ATy1LdlP4VXtd2sLpossoU3Yz+FX3VkPbBzt6Afhs2Y3gN7++vJfg78fvEj960fmX5+DeZ7Sr795NcOA9BacsOvtyZjfb4uf924IPvH/shEVnXt7sVlu840VnXe7sHM6NKuvBvc8M/un6+YnDuX0FsJvu6j8+1r/WH5jcVYWwm4/x9TavA3/mZrpC2I139bOrx5XMrv707bMlDO59TO6OOwlfDjvwQ52AL4ndFH77YH/+pjD4stgN4bcP91V7TOdy0ek2AF/Q4N7HufqBTrjH+WY8xRZ/uQLZGeMvVyQ7s/pLlTe49wF/tlLZza+5W1RPV49OF51BCbE7f0k20ydp6t91ztV3JcTu4UUYDWf1zWn6ldSsPq3BPRJ8d/XVO8vLcLKGT4o9HryPRadcYuxVrDHey6LTLT12D5nAr98/NvfSiMzq0xrcvWUA30ztmnl9KZO783tNDXYj+KfZPrvpXTLwr6XPzpNU2M22+M+P1dN9vodzb6TPwOuwG47xt80TNMtcx3hTeJHBvS/arD7EWz+9rOntvn7o06TY491CFeKtnw7WdfFzxNhNT9l+ttzLX150SPjLybGbbvHzEZP6fOC1Bvc+gTH+UorswIuym99CVeiuXpXd/EKM1U31dONw0UnASw7ufaaHc90vd4tOAV6Y3fxwrv7l9tKr6O7S7KZjfG2+ms3unS46buLsqhdiKA/ufYrwsFcWt1Bdf/+Y6bNzb4O9yfSmyfXdc67Px78O9i7Tw7kavoTbpGHfZ7HFZ3ub9MuRI4P7jwRuk345VwT7QQKz+h4e9lepwMP+JgP4l5ctd/nsXMj27LgfJLDFs5cfajL8+vbU3iAVeNiHmvqKGN2t84N3W6QB37Gn8b2k1NRXxNif1Rk4u5PCD7sf3GM/BZxgU18RI+0tfs8O/FGTXxHj9KXX0X/Y+8Ed94HKndUzpztbqfA2R+6SewRXd9IcTO5ebqd38g2Oy2Zzj/29xslii3/K5po7u7088AMdwufyfLzt4A78QIfwq8Fd/fp20TxpO3CoF+eHOeK0vKK71Rg/9C5UzXH8sn5gfZfGcbyTubzCv4Sps/p6/9/ePZ/GmTs3h3AS+/7Jh3P15r5qXhnp+Ma64D87V0fuwB88SXP6cG7ZPjZwQ2Xgn52759yB/zHGW77JpMmiHefyRJ2AeynvH8/5WdvMdvVLy3M3Jot2GOz2xXrxI4dxQd2Y8n+SBvZRmVxl+6+X//zdZpsPAg/7yEy2+FV3sLZ9sHsH+QDwsI/O5jje8pjOOzyD+4QyHuNhn1K28LBPy+ZwLqF3qIB9ahYncJ5u7F4Twx88g/v0LE7Zbj79aXXq1hs87A4yfUWM+ven67+Or7YYv+ixwe4kw8ld89zrjeWTdF7gYXdUXrN6BndnZQUPu7syevEj2F1mNbmL+XJnsLvN6nAu3vPxDO6uy2OLh915OYzxsHso/Vk97F5KHZ7B3VOJv8ChD3aFq+Yvl/QW72Vrl7hP5nIJw3vayQPfliz86cF9ohvwbanCn97cJ8Ph3pQm/Lm9PFusk1KEPz+4A++k9OAvHrnj7qLk4DlhE6bE4GEPVVLwsIcrIXhOy4csGXjYw5YKPOyBSwMe9uClAA97hOLDM7hHKTo87HGKDA97rKLCwx6viPAM7jGLBw971GLBwx65OPBh2XkCf6AY8IEHdy7ZGSoCfOi9PPBDBYcPP7gDP1Rg+ChzOtwHCgrPkXs6hYSHPaHCwcOeVKHgYU+sMPAM7skVBB729AoAD3uKeYeHPc08wzO4p5pfeNiTzSc87AnnER72lPMMP+HLyWte4Sd8MXku+g0VFCfgRQNeNAV4rsAZKBh8vJ8+19wNFQo+4k8f+KGAFy0f+PFfj/tA2YzxbLduy2ZWD7zbgBctG3hGardlA88W7zbgRQNetGzgGePdlg88OQ140QqCZyywKR/4S67M/qzKBv6iK/BWAS9aOfCM8VZlA4+r2/KBJ6cBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBL9pU+M2nb9VmPptdP9sumqLmAL6xr9Y/2y6aouYAfn333G35doumqE2Gn199/a3Z4u+O9vXAp9z0yd32YXZTrd4dbfDAJx2zetGAF80V/MHkbrZv/HdF3mOLFw140ThzJxpn7kTjzJ1onLkTjTN3ojGrFw140YAXDXjRgBcNeNGAFw140YAXDXjRgBcNeNGAFw140YAXDXjRgBcNeNGCw3OHTRqFhufeqkQCXjTgRWOMF41ZvWjAiwa8aMCLBrxowIvG4ZxonMARDXjRgBeNMV40ZvWiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwovmEp5TzB++7AHsU/6tIdQ3Ai64BeNE1AC+6BuBF1wC86BqAF11DyvDkMeBFA1404EUDXjTgRQNeNOBFA1404EVLE377MLt6rKr17WzgbeszWcVTexnMotrMZ9fPXtdQ/y0+WP8d0oRfLqrV9fPm42P15OmHtl/FfOFvFVWzhu1DvYYbXyto1lD/NuIfb5Lwm0/t32N997z/o9dV1P++/NQsuVnRiA3SYg3V8uq/hWzx67v/NPthn1t8vwq/8M2W7n8NVTm7+vXtovuBeRse96tod/VXnlha72Zf7A1+v+Bi4LutZP3+sVp5mnrtN8R6cvfPz55Y2vHX6xa/6reLUuA3v7Y/LJ8bS7+K9o+ephHV8r5furcxvl1DVQ58M+WutxSfW3y/inYa4WnOvW33JNuHe89rqAqCrwf3Bnw1m/kafw9W4Wsasd+h+JuovOwOi4En7wEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvmjD88BWKq/4+xOb62MXZz8w74N988P3XL9+7C+2BL6DmVrl6Q24Em/9t5rOrx/4PzUXW69v20b//8u6Pu/99aS6Grh/42y+L7oH2k/rPLCYV+Nv75n6jHr7ZllfXf9X/sWzvdmjvpfrwrbmfbjP/dwtfP7CqyfsHXj6znFTgO/GD/2s/tr+PuWpvdeo+vJzN7tsP9rv67oGDzywjTfi75+5j9f67u1mn1n7Xw2+/fJ8v2j8uFz8eePnMUtKEf9ni+619vth/eHWz/fK8vO+3+B8PFLW1N2nBt/dIvmvH+PWHP7qRez/0v+9mex/rWX39Wd0Yf/BA95mx/x7u0oJvXi/oH59ez+qb/Xf94XoO3+4Iugl+89pIzay+e2D70M7qS9rTq8BbtP1S0HZ9OuBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRQNeNOBFA1404EUDXjTgRfs/fzZVNRQXIvUAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-23"/> </p>

<pre><code class="r">par(mfrow = c(1, 3))
for (i in 1:3) {
    nuclear0 &lt;- nuclear[sample(1:dim(nuclear)[1], replace = TRUE), ]
    nuke.lm0 &lt;- lm(log(cost) ~ date, data = nuclear0)
    plot(nuclear0$date, log(nuclear0$cost), pch = 19)
    abline(nuke.lm0, col = &quot;red&quot;, lwd = 3)
}
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"/> </p>

<h2>Bootstrap distribution</h2>

<pre><code class="r">bs &lt;- function(data, indices, formula) {
    d &lt;- data[indices, ]
    fit &lt;- lm(formula, data = d)
    return(coef(fit))
}
results &lt;- boot(data = nuclear, statistic = bs, R = 1000, formula = log(cost) ~ 
    date)
plot(density(results$t[, 2]), col = &quot;red&quot;, lwd = 3)
lines(rep(nuke.lm$coeff[2], 10), seq(0, 8, length = 10), col = &quot;blue&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAqFBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlOY9lZgBlZjllj49ltbVltdpltf2POQCPOTmPZgCPj2WPtY+P29qP2/21ZgC1Zjm1jzm1tWW124+1/rW1/tq1/v2+vr7ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AACGVXSGAAAAOHRSTlP///////////////////////////////////////////////////////////////////////8A/4V6AzUAAAAJcEhZcwAACxIAAAsSAdLdfvwAABMiSURBVHic7d0Le6PGFQbgYCdxpGy3kXbTSypvk1rNpa6SWhf2//+zwgDDIBAamAtzzvm+p6m8XA7aeXUGJJv1FzkiMl8s/QSQZQJ4oQG80ABeaAAvNIAXGsALDeCFBvBCA3ihAbzQAF5oAC80gBcawAsN4IUG8EIDeKEBvNAAXmgALzSAFxrACw3ghQbw3nPYLP0MbJI4/Hn79Da29vE1z/e7O7ud1tnDy8i+h/5a++d3/QzO2yxTBy8WXp6zbNWu2mdZsfW+XH9aL/3qIA2vss/uwQ9tUZGpNeftqr/a+vk1VfSCLFPa5cIu/L5c8/iq4PN9+YJZMgnDl8P2gxI8FCO2Kxc8/qKapuzh8rEY9v8UG2XfPBd/OGabwd3KPxdDfSz+v+jsy7Pa7+mt2XdVbLYrCj6+FhsqwHK36oBlsYe/lbvVz6A58ECVes0xe/r5u2ah2qzJefvwog6hXpXNs10s6cIrsKo71BebZsmqbitj2Eu7fTVh93ar4P+od+mTFbYvqkGPdXd24dVezTM436zSrDmtn37e1Pt14Ys1b+pJKniLqSxs0oUvm7BAUGP5pnqsGM1N2VLVktyYaE9rPcj93fRUXG5uklVrKoLz9qv1wOxbHHJVm5V7NgfuV2nWqJfbJm+m+quS5ZOvDthbFTvpwqsGLAfpWHVgOVHW/aLaq5rqX+sRLlp6dWO3Gr7caQi+JjtmzZn6aqp/UeuqUs2Bh14+1Zqq2dV804c/qovMGn7+FaWX0IKvh1udUJVD08+Hh5/q6+Qb8GqPMfhD1px1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" alt="plot of chunk unnamed-chunk-25"/> </p>

<h2>Bootstrap Confidence Intervals</h2>

<pre><code class="r">boot.ci(results)
</code></pre>

<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = results)
## 
## Intervals : 
## Level      Normal              Basic             Studentized     
## 95%   (-16.481,  -3.130 )   (-15.746,  -2.553 )   (-17.153,  -3.842 )  
## 
## Level     Percentile            BCa          
## 95%   (-17.435,  -4.242 )   (-17.475,  -4.249 )  
## Calculations and Intervals on Original Scale
</code></pre>

<h2>Bootstrapping from model</h2>

<pre><code class="r">resid &lt;- rstudent(nuke.lm)
fit0 &lt;- fitted(lm(log(cost) ~ 1, data = nuclear))
newNuc &lt;- cbind(nuclear, resid = resid, fit0 = fit0)
bs &lt;- function(data, indices) {
    return(coef(glm(data$fit0 + data$resid[indices] ~ data$date, data = data)))
}
results &lt;- boot(data = newNuc, statistic = bs, R = 1000)
</code></pre>

<h2>Results</h2>

<pre><code class="r">plot(density(results$t[, 2]), lwd = 3, col = &quot;blue&quot;)
lines(rep(coef(nuke.lm)[2], 10), seq(0, 3, length = 10), col = &quot;red&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAArlBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j7U5j9plAABlADllAGVlOQBlOY9lZgBlZjllj49ltbVltdpltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1Zjm1jzm1tWW124+1/rW1/tq1/v2+vr7ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AACQwhK6AAAAOnRSTlP//////////////////////////////////////////////////////////////////////////wD/iebt9QAAAAlwSFlzAAALEgAACxIB0t1+/AAAFGxJREFUeJztnYt647YRRkvbiSNnu0ml3aRtam+axGouddXUujDv/2IlQNIiRZDCdTAA/vMlK1skBiAOB7yYkP5UgyL5U+wGgDhAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAfKFAvHd269gt0IG5+OPm/nVp6e1LXW8frxQ7PFQ3zwtld9Ol+u27bMFxU1Wy8ubN01NVrc6LtlXVrL0Vyw8PsfeOpMVLttU18ao1WmVyyXGzmi7Wbl8f5e2NqpK2xZtj8Vux5PZFiq+3YoeJCWPxotu+kwZ3TY89ijduf5FJI3JYvDbd/u9mpeqLp+aXfbVWFhO/N129b/5tMvv0JMvdv/ZlV81qj03A25dmRSlQFGsrFMFu/iaKdS3oK1ZE6Zbsq/ufv+7flKv1HDc3z7IKuVf2rY0GX/FSWJsd8od1/86qS6tBtwt323bAnhRrxf/eFZkqa9w+ywTdd9k5Fi9L9S04zkbplxwe7n9ed+XG4pslr7KRUrzGUBYWvuJFEjYSZF++yhxrenMtUqp9px4MtIeHt06eFnsbisXqQ2XtklbBcfPZg2L0bapcdc5Eyb7iaZR+idzd1nU/1F+EFI1vK5wsooaveJmAopP2bQaKgbLLF5le7VD/0vVwk9KrmWKdeFFIJb5Ttq/6I/XFUP8sl7Wh+opVu0+7pE12Od5Mxe/lSWYn3v6M0gtpie+6Wx5QpYc+n3c3P3bnyTPiZYkl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" alt="plot of chunk unnamed-chunk-28"/> </p>

<h2>An empirical p-value</h2>

<p>\[ \hat{p}=\frac{1+\sum\limits_{b=1}^B|t_b^0|>|t|}{B+1}
 \]</p>

<pre><code class="r">B &lt;- dim(results$t)[1]
(1 + sum((abs(results$t[, 2]) &gt; abs(coef(nuke.lm)[2]))))/(B + 1)
</code></pre>

<pre><code>## [1] 0.1838
</code></pre>

<h2>Bootstrapping non-linear statistics</h2>

<pre><code class="r">set.seed(555)
x &lt;- rnorm(30)
sampledMed &lt;- rep(NA, 1000)
for (i in 1:1000) {
    sampledMed[i] &lt;- median(rnorm(30))
}
medFunc &lt;- function(x, i) {
    median(x[i])
}
bootMed &lt;- boot(x, medFunc, 1000)
plot(density(bootMed$t), col = &quot;red&quot;, lwd = 3)
lines(density(sampledMed), lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAtFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVlj49ltbVltdpltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/21ZgC1Zjm1jzm1tWW124+1/rW1/tq1/v2+vr7ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AAALRQMHAAAAPHRSTlP/////////////////////////////////////////////////////////////////////////////AP8FrvlYAAAACXBIWXMAAAsSAAALEgHS3X78AAAWP0lEQVR4nO2dC5vjNhWG0Ww7JCwMJWnLfWYLpROgZQkwycT5//8LS77HkiJbsnyk871Pu8n4Isl+fSTZseyfFYAlP1u7AGAdIJ4pEM8UiGcKxDMF4pkC8UyBeKZAPFMgnikQzxSIZwrEMwXimQLxTIF4pkA8UyCeKRDPFIhnCsQzBeKZAvFMgXimQHwUjru1S3BLEuLf949vtrkfPhfF4fnOaueteHi1rHscz224vMilDJQrX16EkGaPQtwWVJXhfV/PKJc9b2kcAxmIVxzEPfG6JSrxas77fmNM3CZernx5efhlmZX0rxMvvQuxqYtwsBxEESEvXu7NPymDZTzJHVda+KcQcu+VMSw/S3n/KhcSP5d6TmKnXU3+XVo5lf+Wka1MVk6qdTflYjIaP3wuF1QHiFytyrDJUjmVk3dF+0UluynF/14l+Ottr6BtGU7i8R+/aTNqSrgy1MWrPat2+kF92TVTNkUVSD150t2hqrBHq1Xi/1uvMhZfuntVIXkSVeQPxQ9TU8ErqtXqlb/fPpdK/7gdF/Tx7bx9/MeuTmXjUn3FgLp4GYSlBLX33lSklvtvV+7jekrRq67P201TKY9Xa6t6uXhffDWn0vG+/2KrqYlVlu/7h9fztjw8Bl+aqv5v+11x/PDjtpdjWwZ1KMgwP9Q1FoW6nrp4FYDv+6qSVvW0is226ayq+s/1/i9DemNYrRYvV9KJr4+ik2h6AjdV/ededXDsfWnEvx4e//fy+J9tL8e2DEXT+tfizb3IiKQo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" alt="plot of chunk unnamed-chunk-30"/> </p>

<h2>Things you can&#39;t bootstrap (max)</h2>

<pre><code class="r">set.seed(333)
x &lt;- rnorm(30)
sampledMax &lt;- rep(NA, 1000)
for (i in 1:1000) {
    sampledMax[i] &lt;- max(rnorm(30))
}
maxFunc &lt;- function(x, i) {
    max(x[i])
}
bootMax &lt;- boot(x, maxFunc, 1000)
plot(density(bootMax$t), col = &quot;red&quot;, lwd = 3, xlim = c(1, 3))
lines(density(sampledMax), lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAtFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OQA5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlOY9lZgBlZjllZmVlj49ltbVltdpltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/21ZgC1Zjm1jzm1tWW124+1/rW1/tq1/v2+vr7ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AAALRQMHAAAAPHRSTlP/////////////////////////////////////////////////////////////////////////////AP8FrvlYAAAACXBIWXMAAAsSAAALEgHS3X78AAARuElEQVR4nO2dDZ+i1hWHw0x2opl22+jO9iWpbpu02iTbKZuOL/D9v1fvCwjIvQhyjx7u+T+/ZFCEP3d5OBdQ0K8yIJKv7t0AcB8gXigQLxSIFwrECwXihQLxQoF4oUC8UCBeKBAvFIgXCsQLBeKFAvFCgXihQLxQIF4oEC8UiBcKxAsF4oUC8UKBeKFA/C1IF/duQYtpiD8sn966Xn18zbLt6sJs+3nysOmYN22/WnJc66k8qJmP6yTRbtMkcTT0sCxGqyn3cybbQAziDdvkknjXFFa8eeWwnHnDu8TrmY/rh9+pRWn/7YZq70kyKxqw7diEbgl/8Xpt/mAMqnrSq05Z+CVJ9PpTNayHSt5/1ETJN1rPLlk4Z9PPlZWd+qsq25jU20U570xNpuvx8VVNaDYQPZtdYLlI41SPXmSnByZ2psT/xQT+Ya4mKpZRhu2Sp5+/Oy2mbN+9YS/erFmz0rfmwaIcMytKqSZPu9vaDrs1mxX/WzFLW7xytzFFuUts5TfFN9NM+SZ2tmLmn+YrJfX7uY48TWvC9vOnnxdFxqxP53UT2IvXdaMkPL3t56YzNVW0UOu4GJPVuuv9fFZ2yu3ZTl29nrwu3r5ihRyWX88dfbFZ5GH5sNnP1ebReFB29f9cLrL08dd6k8qwbdFJbIv+ikVfz168KUBtZWcr8GFjatNKS8qu/rVY/6qkZ57ZCvF6Jpf4YivaJeWRwFlX/1rrDtLag1L8Zvv0v/XTl7ndfOyuaFfrMGwPkGW2Z7k/kxRf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" alt="plot of chunk unnamed-chunk-31"/> </p>

<h2>Notes and further resources</h2>

<p>Notes:</p>

<ul>
<li>Can be useful for complicated statistics</li>
<li>Be careful near the boundaries</li>
<li>Be careful with non-linear functions</li>
</ul>

<p>Further resources:</p>

<ul>
<li><a href="http://ocw.jhsph.edu/courses/MethodsInBiostatisticsI/PDFs/lecture12.pdf">Brian Caffo&#39;s bootstrap notes</a></li>
<li><a href="http://www.mayin.org/ajayshah/KB/R/documents/boot.html">Nice basic intro to boot package</a></li>
<li><a href="http://www.statmethods.net/advstats/bootstrapping.html">Another basic boot tutorial</a></li>
<li><a href="http://www.amazon.com/Introduction-Bootstrap-Monographs-Statistics-Probability/dp/0412042312">An introduction to the bootstrap</a></li>
<li><a href="http://www.jstor.org/discover/10.2307/2408678?uid=3739704&amp;uid=2&amp;uid=4&amp;uid=3739256&amp;sid=21101897412687">Confidence limits on phylogenies</a></li>
</ul>

<h1>Bootstrapping for prediction</h1>

<p>Bootstrapping can be used for</p>

<ul>
<li>Cross-validation type error rates</li>
<li>Prediction errors in regression models</li>
<li>Improving prediction</li>
</ul>

<h2>Bootstrapping prediction errors</h2>

<pre><code class="r">library(boot)
</code></pre>

<pre><code class="r">data(nuclear)
nuke.lm &lt;- lm(log(cost) ~ date, data = nuclear)
plot(nuclear$date, log(nuclear$cost), pch = 19)
abline(nuke.lm, col = &quot;red&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-33"/> </p>

<pre><code class="r">newdata &lt;- data.frame(date = seq(65, 72, length = 100))
nuclear &lt;- cbind(nuclear, resid = rstudent(nuke.lm), fit = fitted(nuke.lm))
nuke.fun &lt;- function(data, inds, newdata) {
    lm.b &lt;- lm(fit + resid[inds] ~ date, data = data)
    pred.b &lt;- predict(lm.b, newdata)
    return(pred.b)
}
nuke.boot &lt;- boot(nuclear, nuke.fun, R = 1000, newdata = newdata)
head(nuke.boot$t)
</code></pre>

<pre><code>##       [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9] [,10] [,11]
## [1,] 4.126 4.161 4.196 4.231 4.266 4.301 4.336 4.371 4.406 4.441 4.476
## [2,] 5.463 5.481 5.498 5.516 5.534 5.551 5.569 5.587 5.604 5.622 5.640
## [3,] 5.022 5.046 5.069 5.093 5.117 5.141 5.165 5.189 5.212 5.236 5.260
## [4,] 5.540 5.548 5.557 5.565 5.573 5.581 5.589 5.597 5.605 5.613 5.621
## [5,] 4.696 4.722 4.748 4.774 4.801 4.827 4.853 4.879 4.905 4.932 4.958
## [6,] 5.968 5.969 5.970 5.971 5.972 5.973 5.974 5.975 5.976 5.977 5.979
##      [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22]
## [1,] 4.511 4.546 4.581 4.616 4.651 4.686 4.721 4.756 4.791 4.826 4.861
## [2,] 5.658 5.675 5.693 5.711 5.728 5.746 5.764 5.781 5.799 5.817 5.835
## [3,] 5.284 5.308 5.332 5.355 5.379 5.403 5.427 5.451 5.474 5.498 5.522
## [4,] 5.629 5.637 5.645 5.653 5.661 5.669 5.677 5.685 5.693 5.701 5.709
## [5,] 4.984 5.010 5.036 5.062 5.089 5.115 5.141 5.167 5.193 5.220 5.246
## [6,] 5.980 5.981 5.982 5.983 5.984 5.985 5.986 5.987 5.989 5.990 5.991
##      [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33]
## [1,] 4.896 4.931 4.966 5.001 5.036 5.071 5.106 5.141 5.176 5.211 5.246
## [2,] 5.852 5.870 5.888 5.905 5.923 5.941 5.958 5.976 5.994 6.012 6.029
## [3,] 5.546 5.570 5.594 5.617 5.641 5.665 5.689 5.713 5.737 5.760 5.784
## [4,] 5.717 5.725 5.733 5.741 5.749 5.757 5.765 5.773 5.781 5.789 5.797
## [5,] 5.272 5.298 5.324 5.350 5.377 5.403 5.429 5.455 5.481 5.508 5.534
## [6,] 5.992 5.993 5.994 5.995 5.996 5.997 5.998 6.000 6.001 6.002 6.003
##      [,34] [,35] [,36] [,37] [,38] [,39] [,40] [,41] [,42] [,43] [,44]
## [1,] 5.281 5.316 5.351 5.386 5.421 5.456 5.491 5.526 5.561 5.596 5.631
## [2,] 6.047 6.065 6.082 6.100 6.118 6.135 6.153 6.171 6.189 6.206 6.224
## [3,] 5.808 5.832 5.856 5.880 5.903 5.927 5.951 5.975 5.999 6.023 6.046
## [4,] 5.805 5.813 5.821 5.829 5.837 5.845 5.853 5.862 5.870 5.878 5.886
## [5,] 5.560 5.586 5.612 5.638 5.665 5.691 5.717 5.743 5.769 5.796 5.822
## [6,] 6.004 6.005 6.006 6.007 6.008 6.010 6.011 6.012 6.013 6.014 6.015
##      [,45] [,46] [,47] [,48] [,49] [,50] [,51] [,52] [,53] [,54] [,55]
## [1,] 5.666 5.701 5.736 5.771 5.806 5.841 5.876 5.911 5.946 5.981 6.016
## [2,] 6.242 6.259 6.277 6.295 6.312 6.330 6.348 6.366 6.383 6.401 6.419
## [3,] 6.070 6.094 6.118 6.142 6.166 6.189 6.213 6.237 6.261 6.285 6.308
## [4,] 5.894 5.902 5.910 5.918 5.926 5.934 5.942 5.950 5.958 5.966 5.974
## [5,] 5.848 5.874 5.900 5.926 5.953 5.979 6.005 6.031 6.057 6.084 6.110
## [6,] 6.016 6.017 6.018 6.019 6.021 6.022 6.023 6.024 6.025 6.026 6.027
##      [,56] [,57] [,58] [,59] [,60] [,61] [,62] [,63] [,64] [,65] [,66]
## [1,] 6.051 6.086 6.121 6.156 6.192 6.227 6.262 6.297 6.332 6.367 6.402
## [2,] 6.436 6.454 6.472 6.489 6.507 6.525 6.543 6.560 6.578 6.596 6.613
## [3,] 6.332 6.356 6.380 6.404 6.428 6.451 6.475 6.499 6.523 6.547 6.571
## [4,] 5.982 5.990 5.998 6.006 6.014 6.022 6.030 6.038 6.046 6.054 6.062
## [5,] 6.136 6.162 6.188 6.214 6.241 6.267 6.293 6.319 6.345 6.372 6.398
## [6,] 6.028 6.029 6.030 6.032 6.033 6.034 6.035 6.036 6.037 6.038 6.039
##      [,67] [,68] [,69] [,70] [,71] [,72] [,73] [,74] [,75] [,76] [,77]
## [1,] 6.437 6.472 6.507 6.542 6.577 6.612 6.647 6.682 6.717 6.752 6.787
## [2,] 6.631 6.649 6.666 6.684 6.702 6.720 6.737 6.755 6.773 6.790 6.808
## [3,] 6.594 6.618 6.642 6.666 6.690 6.714 6.737 6.761 6.785 6.809 6.833
## [4,] 6.070 6.078 6.086 6.094 6.102 6.110 6.118 6.126 6.134 6.142 6.150
## [5,] 6.424 6.450 6.476 6.503 6.529 6.555 6.581 6.607 6.633 6.660 6.686
## [6,] 6.040 6.042 6.043 6.044 6.045 6.046 6.047 6.048 6.049 6.050 6.051
##      [,78] [,79] [,80] [,81] [,82] [,83] [,84] [,85] [,86] [,87] [,88]
## [1,] 6.822 6.857 6.892 6.927 6.962 6.997 7.032 7.067 7.102 7.137 7.172
## [2,] 6.826 6.843 6.861 6.879 6.897 6.914 6.932 6.950 6.967 6.985 7.003
## [3,] 6.857 6.880 6.904 6.928 6.952 6.976 7.000 7.023 7.047 7.071 7.095
## [4,] 6.158 6.167 6.175 6.183 6.191 6.199 6.207 6.215 6.223 6.231 6.239
## [5,] 6.712 6.738 6.764 6.791 6.817 6.843 6.869 6.895 6.921 6.948 6.974
## [6,] 6.053 6.054 6.055 6.056 6.057 6.058 6.059 6.060 6.061 6.063 6.064
##      [,89] [,90] [,91] [,92] [,93] [,94] [,95] [,96] [,97] [,98] [,99]
## [1,] 7.207 7.242 7.277 7.312 7.347 7.382 7.417 7.452 7.487 7.522 7.557
## [2,] 7.020 7.038 7.056 7.074 7.091 7.109 7.127 7.144 7.162 7.180 7.197
## [3,] 7.119 7.142 7.166 7.190 7.214 7.238 7.262 7.285 7.309 7.333 7.357
## [4,] 6.247 6.255 6.263 6.271 6.279 6.287 6.295 6.303 6.311 6.319 6.327
## [5,] 7.000 7.026 7.052 7.079 7.105 7.131 7.157 7.183 7.209 7.236 7.262
## [6,] 6.065 6.066 6.067 6.068 6.069 6.070 6.071 6.072 6.074 6.075 6.076
##      [,100]
## [1,]  7.592
## [2,]  7.215
## [3,]  7.381
## [4,]  6.335
## [5,]  7.288
## [6,]  6.077
</code></pre>

<pre><code class="r">pred &lt;- predict(nuke.lm, newdata)
predSds &lt;- apply(nuke.boot$t, 2, sd)
plot(newdata$date, pred, col = &quot;black&quot;, type = &quot;l&quot;, lwd = 3, ylim = c(0, 10))
lines(newdata$date, pred + 1.96 * predSds, col = &quot;red&quot;, lwd = 3)
lines(newdata$date, pred - 1.96 * predSds, col = &quot;red&quot;, lwd = 3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAkFBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OY85ZrU5j7U5j9plAABlADllAGVlOQBlOY9lj49ltdpltf2POQCPOTmPOWWPZgCPZo+Pj2WPtY+P29qP2/21ZgC1Zjm124+1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v3/AABNimU1AAAAMHRSTlP/////////////////////////////////////////////////////////////AP/cg8KHAAAACXBIWXMAAAsSAAALEgHS3X78AAAMsklEQVR4nO3dC1vbyBmG4XXSBgKtDT0AbbbF28VN8UH8/39XjQ7GYFvWJ81oRnqf52rjbJSRBbdHIyeI/JKRZL/EPgCKE/CiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KIBLxrwogEvGvCiAS8a8KL1gZ9RygWE7zGWQge8aMCLBrxowIsGvGi94TfXxZuDry/WXVPU+sLvHh+Kx/W3V+OuKWp94bf3Lx8e2++aosaMF633Gr9dsMaPMa7qRQsA3/KvAShqzHjRgBet99u5RXVeP766Az7les/43eO8264pav1P9du75067pqixxosGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxowIsGvGjAiwa8aMCLBrxGb29vH38BeIHeyj78Wm/4zfXsanXqn48HPpHeTrn3ht89PWerq9z/9vXzJuAT6O00e3/47f1LtpqXj/Uu6zocJ3ns7ax6xoyfbG+N7H7W+DlrfHI1q2dc1U+yS+gu4CfWxaleBfyUurSwHwT8dGqvngE/mSzoLuAnkGmqVwE/9gzr+mHAj7tu6hnwo64r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" alt="plot of chunk unnamed-chunk-35"/> </p>

<h2>Bootstrap aggregating (bagging)</h2>

<p>Basic idea:</p>

<ul>
<li>Resample cases and recalculate predictions</li>
<li>Average or majority vote</li>
</ul>

<p>Notes:</p>

<ul>
<li>Similar bias</li>
<li>Reduced variance</li>
<li>More useful for non-linear functions</li>
</ul>

<h2>Bagged loess</h2>

<pre><code class="r">library(ElemStatLearn)
</code></pre>

<pre><code>## Warning: package &#39;ElemStatLearn&#39; was built under R version 2.15.3
</code></pre>

<pre><code class="r">data(ozone, package = &quot;ElemStatLearn&quot;)
ozone &lt;- ozone[order(ozone$ozone), ]
head(ozone)
</code></pre>

<pre><code>##     ozone radiation temperature wind
## 17      1         8          59  9.7
## 19      4        25          61  9.7
## 14      6        78          57 18.4
## 45      7        48          80 14.3
## 106     7        49          69 10.3
## 7       8        19          61 20.1
</code></pre>

<p><a href="http://en.wikipedia.org/wiki/Bootstrap_aggregating">http://en.wikipedia.org/wiki/Bootstrap_aggregating</a></p>

<pre><code class="r">ll &lt;- matrix(NA, nrow = 10, ncol = 155)
for (i in 1:10) {
    ss &lt;- sample(1:dim(ozone)[1], replace = T)
    ozone0 &lt;- ozone[ss, ]
    ozone0 &lt;- ozone0[order(ozone0$ozone), ]
    loess0 &lt;- loess(temperature ~ ozone, data = ozone0, span = 0.2)
    ll[i, ] &lt;- predict(loess0, newdata = data.frame(ozone = 1:155))
}
</code></pre>

<pre><code>## Warning: pseudoinverse used at 14
</code></pre>

<pre><code>## Warning: neighborhood radius 2
</code></pre>

<pre><code>## Warning: reciprocal condition number 3.6626e-017
</code></pre>

<pre><code class="r">plot(ozone$ozone, ozone$temperature, pch = 19, cex = 0.5)
for (i in 1:10) {
    lines(1:155, ll[i, ], col = &quot;grey&quot;, lwd = 2)
}
lines(1:155, apply(ll, 2, mean), col = &quot;red&quot;, lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-39"/> </p>

<h2>Bagged trees</h2>

<p>Basic idea:</p>

<ul>
<li>Resample data</li>
<li>Recalculate tree</li>
<li>Average/mode) of predictors</li>
</ul>

<p>Notes:</p>

<ul>
<li>More stable</li>
<li>May not be as good as random forests</li>
</ul>

<h2>Iris data</h2>

<pre><code class="r">data(iris)
head(iris)
</code></pre>

<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
</code></pre>

<h2>Bagging a tree</h2>

<pre><code class="r">library(ipred)
</code></pre>

<pre><code>## Warning: package &#39;ipred&#39; was built under R version 2.15.3
</code></pre>

<pre><code>## Warning: package &#39;prodlim&#39; was built under R version 2.15.3
</code></pre>

<pre><code class="r">bagTree &lt;- bagging(Species ~ ., data = iris, coob = TRUE)
print(bagTree)
</code></pre>

<pre><code>## 
## Bagging classification trees with 25 bootstrap replications 
## 
## Call: bagging.data.frame(formula = Species ~ ., data = iris, coob = TRUE)
## 
## Out-of-bag estimate of misclassification error:  0.0533
</code></pre>

<h2>Looking at bagged tree one</h2>

<pre><code class="r">bagTree$mtrees[[1]]$btree
</code></pre>

<pre><code>## n= 150 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##   1) root 150 91 setosa (0.39333 0.32000 0.28667)  
##     2) Petal.Length&lt; 2.35 59  0 setosa (1.00000 0.00000 0.00000) *
##     3) Petal.Length&gt;=2.35 91 43 versicolor (0.00000 0.52747 0.47253)  
##       6) Petal.Width&lt; 1.65 48  2 versicolor (0.00000 0.95833 0.04167)  
##        12) Sepal.Length&lt; 7.1 47  1 versicolor (0.00000 0.97872 0.02128)  
##          24) Sepal.Width&gt;=2.25 45  0 versicolor (0.00000 1.00000 0.00000) *
##          25) Sepal.Width&lt; 2.25 2  1 versicolor (0.00000 0.50000 0.50000)  
##            50) Petal.Length&lt; 4.5 1  0 versicolor (0.00000 1.00000 0.00000) *
##            51) Petal.Length&gt;=4.5 1  0 virginica (0.00000 0.00000 1.00000) *
##        13) Sepal.Length&gt;=7.1 1  0 virginica (0.00000 0.00000 1.00000) *
##       7) Petal.Width&gt;=1.65 43  2 virginica (0.00000 0.04651 0.95349)  
##        14) Petal.Length&lt; 5.05 9  2 virginica (0.00000 0.22222 0.77778)  
##          28) Sepal.Width&gt;=2.85 3  1 versicolor (0.00000 0.66667 0.33333)  
##            56) Sepal.Length&lt; 6 1  0 versicolor (0.00000 1.00000 0.00000) *
##            57) Sepal.Length&gt;=6 2  1 versicolor (0.00000 0.50000 0.50000)  
##             114) Sepal.Length&gt;=6.4 1  0 versicolor (0.00000 1.00000 0.00000) *
##             115) Sepal.Length&lt; 6.4 1  0 virginica (0.00000 0.00000 1.00000) *
##          29) Sepal.Width&lt; 2.85 6  0 virginica (0.00000 0.00000 1.00000) *
##        15) Petal.Length&gt;=5.05 34  0 virginica (0.00000 0.00000 1.00000) *
</code></pre>

<h2>Looking at bagged tree two</h2>

<pre><code class="r">bagTree$mtrees[[2]]$btree
</code></pre>

<pre><code>## n= 150 
## 
## node), split, n, loss, yval, (yprob)
##       * denotes terminal node
## 
##  1) root 150 95 setosa (0.36667 0.31333 0.32000)  
##    2) Petal.Length&lt; 2.5 55  0 setosa (1.00000 0.00000 0.00000) *
##    3) Petal.Length&gt;=2.5 95 47 virginica (0.00000 0.49474 0.50526)  
##      6) Petal.Width&lt; 1.75 49  2 versicolor (0.00000 0.95918 0.04082)  
##       12) Petal.Length&lt; 4.95 44  0 versicolor (0.00000 1.00000 0.00000) *
##       13) Petal.Length&gt;=4.95 5  2 versicolor (0.00000 0.60000 0.40000)  
##         26) Petal.Width&gt;=1.55 3  0 versicolor (0.00000 1.00000 0.00000) *
##         27) Petal.Width&lt; 1.55 2  0 virginica (0.00000 0.00000 1.00000) *
##      7) Petal.Width&gt;=1.75 46  0 virginica (0.00000 0.00000 1.00000) *
</code></pre>

<h2>Random forests</h2>

<ul>
<li>Bootstrap samples</li>
<li>At each split, bootstrap variables</li>
<li>Grow multiple trees and vote</li>
</ul>

<p>Pros:</p>

<ul>
<li>Accuracy</li>
</ul>

<p>Cons:</p>

<ul>
<li>Speed</li>
<li>Interpretability</li>
<li>Overfitting</li>
</ul>

<pre><code class="r">library(randomForest)
</code></pre>

<pre><code>## Warning: package &#39;randomForest&#39; was built under R version 2.15.3
</code></pre>

<pre><code class="r">forestIris &lt;- randomForest(Species ~ Petal.Width + Petal.Length, data = iris, 
    prox = TRUE)
forestIris
</code></pre>

<pre><code>## 
## Call:
##  randomForest(formula = Species ~ Petal.Width + Petal.Length,      data = iris, prox = TRUE) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 1
## 
##         OOB estimate of  error rate: 3.33%
## Confusion matrix:
##            setosa versicolor virginica class.error
## setosa         50          0         0        0.00
## versicolor      0         47         3        0.06
## virginica       0          2        48        0.04
</code></pre>

<h2>Getting a single tree</h2>

<pre><code class="r">getTree(forestIris, k = 2)
</code></pre>

<pre><code>##    left daughter right daughter split var split point status prediction
## 1              2              3         1        0.80      1          0
## 2              0              0         0        0.00     -1          1
## 3              4              5         1        1.70      1          0
## 4              6              7         1        1.35      1          0
## 5              8              9         1        1.85      1          0
## 6              0              0         0        0.00     -1          2
## 7             10             11         2        4.95      1          0
## 8             12             13         2        4.85      1          0
## 9              0              0         0        0.00     -1          3
## 10             0              0         0        0.00     -1          2
## 11            14             15         2        5.35      1          0
## 12             0              0         0        0.00     -1          2
## 13             0              0         0        0.00     -1          3
## 14            16             17         1        1.55      1          0
## 15             0              0         0        0.00     -1          3
## 16             0              0         0        0.00     -1          3
## 17             0              0         0        0.00     -1          2
</code></pre>

<h2>Class &ldquo;centers&rdquo;</h2>

<pre><code class="r">iris.p &lt;- classCenter(iris[, c(3, 4)], iris$Species, forestIris$prox)
plot(iris[, 3], iris[, 4], pch = 21, xlab = names(iris)[3], ylab = names(iris)[4], 
    bg = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;)[as.numeric(factor(iris$Species))], main = &quot;Iris Data with Prototypes&quot;)
points(iris.p[, 1], iris.p[, 2], pch = 21, cex = 2, bg = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAolBMVEX9/v0AAAAAADkAAGUAAP8AOTkAOWUAOY8AZo8AZrUA/wA5AAA5ADk5AGU5OWU5OY85ZmU5ZrU5j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPtY+P27WP29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v3/AADZXF+9AAAANnRSTlP/////////////////////////////////////////////////////////////////////AP8fqVzOAAAACXBIWXMAAAsSAAALEgHS3X78AAAOrklEQVR4nO2dC3vixhlGI+zEwezWDWTTNq3ZTbKQpCY1F/n//7XOjCQQRsCIEWik95xnn7V1+5A5mos+aaRvUpDkm7Z3ANoB8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBcF8aIgXhTEi4J4URAvCuJFQbwoiBelm+LXk7uX978V04nluTxvvjd1GMcs30xLYapiVEU6HrcDdF384RInLRnvZs2rFKb7y6vED2ZVa/rHjZvuit9MBz8ng9/sIbAaJUkuLjsklnZy6eRtpubHMJ+wazjHC3NkrCcPf03u/uuWm5l/jHYxHl6t13H2ETOztj2S8kjlqe+n7nPMine/57uwyOuK0j5FSZfFm6/YqnvJSqiVta0LTGnM5/7P6SqvsjBi5u5YGK934l0hH+bRt+LdRvNsWS5+b8rFyo8uF3+e1zflD4ySTosfZr+tRrsvOBe/yKphN1VUyUX7sBoZ4f++e1kMZtvlJtg4LeJsq/rsI1YjU+jXE/OfXfP9lK0sXtzmZrNnF8LOKe9TlHRZvK2610WJ36vqM/F2/lZ8PuF+G64+/PphNrdbbsU7nWXxZkb2EUtXEWT1xPO7qc3U1DnDvItg2o9lkh8z5X2Kkj6Id+1p3oLvqno3sxC/nbDM736/+3PyHyOsJN78shOfl9bz4tPF4NfRuEJ8eZ+ipBfiLfNS5e46dwtXeeditxOW5eBn03D/ffTsJ/5UVW/9uqqhXNVvibnf3wfx5eK8O53LCp8Tmwy3E/k6Y3MoONX58lPii+6c+2X4bsoo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" alt="plot of chunk unnamed-chunk-48"/> </p>

<h2>Combining random forests</h2>

<pre><code class="r">forestIris1 &lt;- randomForest(Species ~ Petal.Width + Petal.Length, data = iris, 
    prox = TRUE, ntree = 50)
forestIris2 &lt;- randomForest(Species ~ Petal.Width + Petal.Length, data = iris, 
    prox = TRUE, ntree = 50)
forestIris3 &lt;- randomForest(Species ~ Petal.Width + Petal.Length, data = iris, 
    prox = TRUE, nrtee = 50)
combine(forestIris1, forestIris2, forestIris3)
</code></pre>

<pre><code>## 
## Call:
##  randomForest(formula = Species ~ Petal.Width + Petal.Length,      data = iris, prox = TRUE, ntree = 50) 
##                Type of random forest: classification
##                      Number of trees: 600
## No. of variables tried at each split: 1
</code></pre>

<h2>Predicting new values</h2>

<pre><code class="r">newdata &lt;- data.frame(Sepal.Length &lt;- rnorm(1000, mean(iris$Sepal.Length), sd(iris$Sepal.Length)), 
    Sepal.Width &lt;- rnorm(1000, mean(iris$Sepal.Width), sd(iris$Sepal.Width)), 
    Petal.Width &lt;- rnorm(1000, mean(iris$Petal.Width), sd(iris$Petal.Width)), 
    Petal.Length &lt;- rnorm(1000, mean(iris$Petal.Length), sd(iris$Petal.Length)))

pred &lt;- predict(forestIris, newdata)
</code></pre>

<pre><code>## Error: object &#39;Petal.Width&#39; not found
</code></pre>

<pre><code class="r">plot(newdata[, 4], newdata[, 3], pch = 21, xlab = &quot;Petal.Length&quot;, ylab = &quot;Petal.Width&quot;, 
    bg = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;)[as.numeric(pred)], main = &quot;newdata Predictions&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAllBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZmU5j485j9plAABlADllAGVlOQBlOTllOY9lZgBlZjllZmVltbVltf2POQCPOTmPZgCPtY+P27WP29qP2/21ZgC1tWW124+1/rW1/tq1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v05eYV+AAAAMnRSTlP/////////////////////////////////////////////////////////////////AA1QmO8AAAAJcEhZcwAACxIAAAsSAdLdfvwAACAASURBVHic7Z0JY924cccDu9nam24rxWmbxtomlZJUSq0D3//L9fEAZgYYgAB4AcT8N45FEhf5wxzA45N/o0Vd6jdnD0B0jgR8pxLwnUrAdyoB36kEfKcS8J1KwHcqAd+pBHynEvCdSsB3KgHfqQR8pxLwnUrAdyoB36kEfKcS8J1KwHcqAd+pBHynEvCdSsB3KgHfqboA/37/0w84evruXFSDvmtOQ833+8/PpDY90aj6A/+kWPCfHhdrcrWb1QXAfzx8/qtSoxG+jKZ7O/F8+/FuxPbxoNSfBnyvI93hUH2ZD8bqE9sndffx8OmPw8mX2f5NzdHAh4PPz1PtyeKHYne497ev8yia0CXAjyb7ZaCnRhovN3BPI967+eKAb/z7/2Z008mhOgI/njONoJozcfX5fwH809yp7R232YCuAf7uxvinH29fb499MPe3r3fv9//1+fnl0+Pb19H6DeOR2OSsTaS2rv7WzpfBbm0jc82h4HjwNM6nKca/fb35hvf7sRbqvR1dAvzI4Kcfr2pG+H7/5e3nP//8+PT5+XWAORn1QNiCnw+0AX9rYmxH20ZszYHz6+DVBxnw49XBtdjex3bE1R+oMaQT8Prp818///3+T/eDt5/xDRHYgrcHGuVvcfBfps4Y8HPvU6N8jlihrgQenO3rpz/egvW/fh0Qzw57SPasw7YH2gNvG/Fd/VCLcfUG/KB2kv4rgZ8TrtsPN7c7pHhzNj6emyx5ysq+2APtgbeNcMndVNtJ7uy0gzYb0KXAjzSGv2+cvo8Z15Tz/9s8K+5eJjc/pu7jgfbB40bGmlMW+DS58aH2P5zlHHL1zXj6K4AXlUjAdyoB36kEfKcS8J1KwHcqAd+pBHynEvCdSsB3KgHfqQR8pxLwnUrAdyoB36kEfKcS8J1KwHcqAd+pBHynEvCdSsB3KgHfqdaAV6KatSP4FXVFe0vAdyoB36kEfKcS8J1KwHcqAd+pBHynEvCdSsB3KgE/aXEP82oS8KOUbmu86yXgRwl4RwL+qhLwkyTGU10DfHdUE9QD+P78eIIEfKcS8J2qB/AS4xl1AX5ftTmtBPxaNRpIBPxaCfjMpq8iAZ/Z9GUkMT6vadGpEvCdSsB3KgHfqQR8pxLwnUrAJ6jNBVtcAn5ZjW7RxCXglyXgN226HQn4TZtuSBLjt2xadKoEfKcS8J1KwHcqAV+k9tM9AV+iCyzwBHyJBPyKpptQwKUL+BVNh+vVEz+DgCsaY6HqA1+TNdU0lo0l4AMabbqSsewhAR8dRfsuPaT6wNfxsOuYfjuqQvBVSMDv1nTlqsLv7KgWwV+dySFqEPzlvfAhEvCdSsB3qgbBS4zfQi2CF20gAd+pVoN/+6runpT6/JzbdCu6aGBZC/7j4bt+ulF/++VHZtON6Kqp5Frw79+e9evd9LdpMu2frW1EAp7XYPGDxOIb0+oY/34/kH+RGN+YJKvvVAK+Uwn4TiXgO5WAX6OGEz8Bv0ItL/UEfLnsG9gtqkvwA7GIl0504Gr+r031CF7pqJcOXXLnQ9uv3Qv44OWl0y1HeAEfubx4umF77xN8WYxPNXBUu+aZ0SX4MqVhRPOj6lgg4D2ts1MBv/qeT3KUK3EJ+LX3fNZjW9uvxPiGwGNC0O9qbgK+tPpBz412ZXDFBpCEVFx9Yf2d7QXa5wkVbO6VlDpJFYMPNbvRfFjMwgT8Pk2vaDW9ZWaWcJ7c24Yfj8NTLHEQEuM3VBZ4prA9tcqga0aapn7BJxh0+3jDag58Fo0o+MVqVcfotWoPfJYiMX65moDfpen6VQq+iQgh4CNaSu4DtXQL9y7gl5TNsY3UsHvwi3hKwVdu+L2DT1iyh0uE/hmDFlJDAb840KBPgL0groSAr1pr8KBgzqGXGF+1VuAxwXx6c7ON27VqGXwJs03N0Cz3BHxO06tV4qX3CLyqyS/RCfgNBtLi7/i6EviEp195qn2gGgbvgk6C2p5p7qSWwY+doJeZM/vceQ5UPsUaB49hZ4InVfHr1XnAQsVrDyoXAp+AbEq/p2Ko6uL0oS0HWomMrEJdCbxeYj+vutGem98K5whoL6FW4iOrTaeA3zD8ObYY7ZYiC7xXz82HEvAS4/kL+zyULPD4AhvjU8DXzjeoZsDnfGmJf03e/JCMCsYZjvHNqgnwSrF2ypdkAn9uf6Q156erqIUYH4+lwfJg5xl14yO4kFrI6ovAO1F4XTzGGd82y/zT1Qz4rO9RTEHYtX0nRyv6Ykam7dfrKloAX2A2FDwHjfzeq+U3LhfCRuj3aAn4feU9c/TPIYXAz3PDu7DQE1s0GIwE/K7yHy/+hJzPzT3wqb/BNvZiJTMlJMbvKMeU/RUdefzGE8DrUubHnAQAtRKz+Fq5Xw/89LODER/RbH86YzcK0Jem4sM3aaP5EWI8cSv6yMeQpUuAh09TrAFSG8fnmLigZ69vX5tc/n3kDnjvAnNQl64BHvXIPWviBUKsJqPVCH1CVwI+v+kdZJM050MXReK+H/DRXr57JtyX79hhDLjnNTe0o64H3v6xcRvFfMYXePMg9Jutc9P+AnM/cJ5UAH77T+chaGPwXEeeVw8PJshxu82bIyPD+eB3uNsAeLZk4r8rEw4AIWci4BOKbX23eGEeD7TkE5xIMUj6oJq95EUMr1DisLWA30AZMdmkf8F/uMImhQoO8aWA4+A2jjYY8hY6H/zC3W75LEJtmdCgEFuvBH4ZhK7ZzHyJO/vKlnYVgF9sJDUEF7eFwDOGC+Hdrs/c8BGweAG/qpElqArbIjrJDijmyPmdG5skao1iggt+uUMBn9nIUtrNZtV8mq1CLcEWD9qsp01Z8HBAKvIRIjPGH6jawS9/YJIMnsvcnF09vA/gtW+3dPEHgMq4gZqgpqh68DxD1yLdB8+D9yxQzbHdKe8coaWbnShmhrT5WxH0BuDfvqpPj1q/f3vObDpZjJ3qAJhYJRo1SJIWB0+bgMWf7hr8x8P325+7PcH7KsyT6EIcPLefmwU9txvRbZqf2HvSyUO0FvwE/OkLAq+U9Yg7qTRBRj5aWdNdHiis4eBY0WNS2PspOOYTM/0tLP6ml3/6XanFl8yQ0lmFQrRLL1Zpcg8aMnk/OtjC9qxz3S8edxZ7+4LVMf79/m746+VzIfjUSb/Ng4DsHbAvGzwBj6utAa+4k+HiW+v0rD41QiY3uNAMpPLw5OPh1wfvTQIyTm5NqL2C/GqEXs29uxw1Dj7PD1APb+mxiJwMTntAua0bvC2wNLb4jV8ffCK7JceaOiBL3CzIcPS2yDG/wICNweMRsNMoPJzDPpxi249frmADx7TGuuOkbpRrq6FWZseP/os0qteCP1fNgA92QUMs91EJCeh8CfDNFnqip8bFcMZw3go9TW2DZ1Irv1sL3t+lcT9bxYs9TXZqF7t2zlVv942DZ7r0HDmAd8r671kqsH0F1/xWA+aMTgv49OJrfSO/IaIC7t0DT7fxcEsk+cMZotciV6dSVQO+6El5AdZHjPnSvVUKXs08LTnGes2KnnchTqInMT69dO6j8lNqrgy8V09L0E1bBWfgui1mJk4y+KzbOWOSXB482pZ1S0ysNQDn2iM0Z/D0kxgV9RK5t3GUqgFfMu3pEwtvfxqD1SHwGkJ8DDx2EnaqKMX1jKot3ljn4LOaRvtu8UIEFLf4w5aOJgEPHod7usvnk+fSROeS2+iRahL84pOCjVmNvLHyiphVuwac0Lz1ATgvsCVtJ9Nf4eH4PXuj7zrGQ7XlpwCPzrVhhalY8Np/2jR0uzs55o+H1HoNg9tMDXfMka2cUwzcU3XgUx4LtjuSp2tEzFozBGSyMwtW63IzZQE8zd+sN8CthO+iCs/uqUnwoXTNMVUU2pG3RzPDOgQXjU0MNH2NHkV+tFhgtwUjd1HFEr9N8IHCyMUrBBmFYbBUFOOR4duMTCE/rjjwcX51WHVMaeBfx9v3365a03SwWo49cDGeSdO0NuDt9hz6JgT2/W5W5yUIOF6kDawKA/eUBP7994/bN72LvBwOY1LWjjWyaTpHtGPpJLOnob5wSJUoDbz/0vz6pnfR0lNGYRs5cQIeJwZg8SiVS+gmZ0gnKc3Vv9xt3/TWIpl7rBQTBEiMR17ATgCTBYbAM90GEtBalAD+/X72dsfE+EKlPF/rsx0DR1VRBjhb+vhnATzTucKNJd3AsalAdVn9mt4WeiQbMiSBd8Br7BlQ6kdiPPYvZvqgFolL2Wb8myojxudG+p1vw03ol3tk9mqQVWOGaBNXw0RwOqcvaKMsXqO8oWXw1tX/9GPLpkO1Yh4vYKbLFVF6buM4jFIp1+rtstCuC0h3OABo6gvA1tmt4uCAKwR/aFYfvX9sh4AmvV3rv1EvjGVyrS+AJxedoiHumnbReYzPAe8/KnLGO4DlmROuzXXcjbN2d9n6MZ7pOO69Yne6v3Jc/RFZfTJ4tEvHV6YHdqpAVczMcdbKj9EBtrFTcbT1g7/paVjHv3zZtOlQreQY7z+5CHiyTIe1uUY/o1kCxOfLzqCovbvdodVg7CEc7Nvd3uOXK87qw2lV5ABDnn3HtEeLCpOM3U0JcM+kf+wa/A/16lMS+OF3ndws/pCsPtqis4LzzJ7EZSbgA0ab3lv0dl4oExmgoEbWbz0CvoSmlv3vbJuOK83Vfzzc7iHT028P3oBAZ0h+7u7KkboOeOQwwJW78R/1ae0YPspXtH/bBvPiToVKA79H02UNug4cLbi1/9N45O2jIVt2AjIT0ecTyuz+KDxblIL+8ZisM6jX6JsET0zbUtQseGDtOF/sK8gfJpODj+79/1yyJLGrN8wngH//9vdpQbfnci7JMoyNEsKYqev0NZocEJKpqWsEXXHQlVvDmLnyy9NuGwe/U9Ne2bTybliHnIyHMF2DtI1mX6RRfxQmJ7D2TsuTbR/2hsIFzlaKxd+r7zs07ZVNLe+EcMudzehQHmZzMrPaCmzCuOHAVGZG6EQPvykvX6hmFqRZ/JPK/ohmP/DexonNxxyrV5Ya5OqQnbkNcUPBjXKFSeBhBunM0bl4FUp39a/nx/hITZx0I8NFzxqScJOLI3fsDBsn5SbKM0M1HiU4fdoHP+zX5/r7427Rhmi8FeNGfjMxzNDQLi4ZqsJFFcwfdJ0sEzR7p96ksrNuw/teoxTwN+qfCl6zPfwWlYUJRo+4IwzWdXPB23EdpkW4ZHBb38At6rQ3nYL55ylKSe6KXq7eD7z79FirUki2lHOEZoc7crJVg+eLaUZT+uFRWW90giXElGLxw4ZtwWu2O90na0u+MQOxOVhrfKgh++KitE0D6FW8b4fCQGyXVjl/qlFqcveSn9YfCd4BYY8APHLThr+13uhiHHyDBW8bgYKBRpTpdUX2uo9Swe+d1ec1i3MtsGyliXVqZJ1Olm1roHiOW6TLQ/AUClIIZ1D8qo4N/3UoDfzw3bncD+eOifHW11oqOODjfE4pdBL7X8fV48zQdRzK9kECBvrB8QTVck9K7u7zoSc0vY1QLufYVyiqIh+P0nJ8HYdyMjdQ5hjoxHNHXlSoRemufuumNxC1XwMUunfNUQNn8N4eLILd+g0MHnw41CWZgzPCutK6SRngK3v1Chssde+mexu8ITt3bNyGZjxBrD+A1uxnAbgZbaYPOoP2g2EcrYPfuOmVIqbuXbQOeQaPduBMPmdLKlOB5n6AGPsJZb0KBAGN+lK0eS3gt5bn452eVRi8G6PBS5t2aYzX5JSC8rYLRBsWf3Y0rcb4Or8ti502woeuOTEe+WpNSzp/oXwO+Xrs6CGPnBvDkwlSCHTMHpyqZi0ex2fspk3PCpm9RoGd2iMljqYRrmJ/diI/dSAoYjBTizk4V+2Ct3044JEhQjAmNRS1Rwj82mkJVSa+HgcYvHzHIYb4Cjv9vOEcJtfXpIF/qc/VQx8Kh2n0bDFMXIMmX8gpIItVNjDQzsApkPmCR6PwNMBjUoqZh0fJ6zkJ/PvvH1+/HPQVqsS22RW6+2ydJw2OGINXAAuv/zTlCk7eOhli2NpWcz2NGRMx/cNVCP7b8/S/7L52UsByrCGitbWboLmVTZw2VMgPtiT2E1AMBRdtLzEhJhB1jlQZ+I9fH2//e/P/+djFvnZSELxBjty2RvBMVo4IWk+BNmlssq5hFnirczul3MHQGG9PnQu+MMbfmL9mfyZ/EHh0RxYPD96xUmv9LnrgZkt54FEYSCV6mptnlQZ+j6ZXCXlX3BPxwu5uupfBexEc7BhPJuv+PVepyATKG/fZSo3xurq9etQL4MOm6i3bFeaK+FqLx2mBjQfkTtwJl5mxnezusRLAH/vLjyLtsc8X+WXcJ5fFKZgOisZoJ2U3pb1uvRCTSbIt8Mf88qNFs2FzKO0AYMBjH2AjPyzPsAeAD9lc/x3I44IkA3fjBYzznH8tMX7ZFlwU9lDpEHgc48EpG9wKpf8WO3L73noMfxxL7J4MU3EZAVxkkmuaohykNPAfD+qnf+S+ZX0IeJxckefmxmhSCozaMXy7dKOI5nSAbMt7PaLugo7AO0+Cx+Iz2FBJ4D8e7t5++fG6Z4xPuGn6lNETjhqKwohNPcRcK9qM+ViVziIDng6WGfS1wN9i/A38vll9tptjkiumDZKsm1GhfN9eB0/u2butzIDnXXfI1XMuwls5HqMMiz//lx/xfSjtemB0HRbzpIZ93Kay6wiUN3w8G+wkcrd1UAgpuZsaY3xgNce8paHssztA2O7dLEApB7zN7dwG8Hyw+75aO+YI3t4mEDQHzBv1uUoDH9H0q9AKmt5QLHhreNi6uUGRmEGM2HHvljKcXww1sfHy1w6aE6vBh79TeTh4LyFDtouLsZUhBcTgybrNujHUEM4Dk2N0pOBhcT4F/NvX/C/HLzddopA5+J6Ze4QOL/esWdYBy3lvx9SAPNE2NM8T5WeaMcttBPzHw3ed+5FsQtMFWngqTIx3CoBVEx9u3IVljl2I4/bJDLNl8LZfwlDDs6Im8MMy7uPX/O/Irx8/v1birjiXl5r0bdP8nwMeynnV7EmogzJ6FaK7FMMrivEj+Id8X7/6BvjnzF7RCOmCk/WX/9pEc2PyvmlrGs1xl2gvAA2SW+mFRn6KmgIfS6Owrfldo4qwN4uu4eCudGTykGwPOQovZwis9JoC7y/Vt2g6rQG+kRD4UC160WGnyWQIzhkSAzzfgeaR5s76Izl5KZ8AfqemU1oI50B+4qZTwJOKMAvs+3ZOw2D/8GEeBu8m+aSLaIw/3fKrBp/XnbOfik6H3e4ME7kAHJgVAg9bQQY8/nA3+14F/FYKLN5iCR/6MNYaqdYoxpM/VqT5cB7ijsmZj169g3UV8O6DtKty9xq2UHf1ZsGb6aIxcOU4DpMc2FTRzS1pv/4AN7r1MrUOPpDnW4CK+GfE0pZCkdtaNPgJReGTVMEtrbVWAv4Y8KGUDiwXrdFwOYVLATmSesEEsTHenNaWMcDPAr+lqy+aQ+2Dx37WOc+st+ghyenRHg5N2InVoxYUbQ/chB0FTvx2i/FlTTUPHn98bs8CJeLG8TV/wljghrQGnsoauw/ebdEZIP8gBPxKuQmV6djGZLwxo1Al6ocxV+TXtf0RcgHcJt4AIiPwQgs/8E3UJXg/e9PI50KG7pWhE0GDAVvTVZg6TgJd96I98CS07J/F9Rvjnf0ZH7zWnl0Q929bwgm8Tee8qO8OIQLe1qtNVwBvHDucVQgaOukekxwAmgT2KNdzEgI8BlwCTsAIBXxatSzHZcj5QZbOBShMSkHMpnWNi2YaCYwD+nfml449if3jQLDn+OXjwWdYCDZDx9cS/2qervcZeTATh8VCFDzPN5joMQ3o0se0WueAjzyM9GfhOGgbo5El277mUO6+HGFTNm94sCKg6OHQJAJmUgWzCWbkeG3fE/jYo0kG7/htHK3JvgnQpj7Y1vJdA3YmtBtoDb+z49WNO3B7i2SCHqzqwCeGPROImVbtB6bzWSjnN+17DTqQZfDencQ7JP0csdYLqT7wiW0z+3XwB9EKmDn7MxkWuPoQeH8HgRYJ3ScCf1qIry/Gp7bt2ruGGK8IED+31+x0YMGTcD+3hmM8t3RAqaHmnwKJ8SfpHPCrRcBxlr+YPnJQaBqnNULoWymZD04raLPnNLILahR8bKW89LiRKS92QZaKBHw4IUdp5okWvaRWwTv95IDXxCIXW8fLBfghnJCbAontn6W2wLMW5D3iRFMOF4vGDrzC56phl7AkifHpLXLknR0WvgAGhs3Yz/FMKh9MIviJk2/q/WX1K1pcYqyRdZpMXM9uWdkfFV6LUYTok1n+FhQUYkeXbsYJ97ObGgbvHNF1nPcH5/KwNGOSbx88Z/CMtfrjid0Kzhq5+nurKfDcess54P/YGWG9vblEE7eZhjJb+AqdhDHYgOGPDjIBHX0AJiwE72d3NQQ+EFPpAVDFa2/kDWAf35kT9oDGeG+P0AkSgSGlgV88t58OA58WwCKlGN+qgKZnuZgL/0hRrEa7cnBoSqFtWmdl77W7Cvw1Y3zadI6VChuJZU8NE5wp9Q0kWceXwDGgTTnUBhwug0+K8WfqMuCdCySZi+zzuXMCwCMTdzijMFDm12pQO+DZbXHNgEfRnEOjw+DtKn/GbNM6f7XADqkd7C3F+Eh54uJt1j2PgV2MsT1CiDfsnezdSwD8Zpshfxj4PUTSc9MpXWSTxZifupHWzJ+5TsidB+ue+V5FtloGD0s3Dzy7oF7gaKCjVyxQB5FBQN05LWxBTYPXPkzPQWeC18bWcYYQuROS97lhZGn8Z86StsHDAhxOkhiv8c/gxwPtkbwAZfV8OWjTdqtz7vrclKAF8CFWitq207VCB84E8VNCpr9gEbfxcJYfl4BPaCdInr/qsJnzPbD8xRycSR7AhWiGtYd8eQ4I+IR2AuDpVWT+1Bvb9ZlZlWOyMdOHS2Te+OPxzqVQlRi/3E7YKSN+OpCRmeWZ5sHHPIrW4CV05G15k+MF3EKFagB8wDI84w6CB4uHLRq05ouYPqTp5H1uJt/TZGoJ+P3kP9kl8LBKo8Q501d4rpgzbuj3FxMawkPtezkXAh+K8YQ0WqF7AJ2oYddyxM5hprBTTy/u+FSiK4FHF539eY1BeuD9Jo3zcHL/JfAt7dg3Cz7mS0NE7bI/sAbz0gXYvXXb0ZpeCndeqdoFv9AzNXkUd6n/ZirbNMDGeEWukZIc+cqj+6SLg0dR34DinTSta9yDjpZtxLZ5NQg+waLQHh1effsLOKaqpgmagN+66TXN8r6XWV4r5I7xdoyT/LmfukA2GGiV/KDacO5UbYPncm5aFm+7hHyFInRhya8Vy9RLHWFCNaRmwaMdE3oBCiLnzl1nAwLqxqT0bJpIToU8Sc1qDzzZJNNh8MpjxK/udYiveftOuXV0CDxODWqfAg2Ct40jT4xX59qc8bDhi3ZmmJWbz9Jcd7tllv/WdXibgLWqafD28XLh3WPmbsRMBdDS3q8ctPjAoDjbr1Stgqe7oyx4Cg0n6OAuyGd0KB0wBCEGQAafMCgBv4M8y9UQz2kx8OV6BkvmCUwFusI3tUlvaSShlMT4rUXzOcATWG3Dt6gQeOCtfbv32zA/Ldm6boC3VdvgmZNcKLc5WXBVzmXr1ICdjIFrpR3q+nrgXX/tfKuGQQOrQz9coGYXgntoZNWqOfCBz0LtLiruGHl075pbnXP1kPAtQRXw6U3vo1h6xQcEbQCHYvxC8Cb5YUfg376ON8z8E+PnPIRYGh6yfRrnSQ3mXKhEX+A/Hr6Pf7/+9COz6S0UedJRZCx4Paf3ya04Jfpy9e/fnsnfGrze/g8h9qhzwJMtXFormA76TfUF/lSLj8ONLr+4HR+tuTjP9ErJk7V+M1od49/vz4vxK2yMSeGTwZuCTavtrL7cxkLgE1pMA1+7+bcNvlz82i1tyEvbt4H261Kv4FdZZIpb0PymQDW6KPjTHzK7DViTLVwTfOAhH7nDEtn4r0I9gd8uHS+ZQAL+AO0Mvozh6eGH6JrgQx/hae3vyhY0VZnxFumi4Hk5n8+n1WGKC/g1TZ+lDcBX5rWLJOCLi7dNvz/wG8T46bwuvMU6JkyH4DdSKfhKEgQBv6CgfQr4wqbbUARTocsW8E1oB0wS489Q7lOvxD63V/Pg80jmc6zDPrdX6+A3W5X3JgHfqToDX+y53a9NN6/WwR9EQjl/2lfz4DcR/m41O5EE/HZNL1Q+0qUinAGyAn67phfr7vSA4y9WhDqWGL9Z04t193nCCy9WXMekFyTgx5NLMf56qhT8fs+/G5NeUK3g91MvJr2g/sDn6bLTRMBHdd3A0CH4HCMW8Ns3fZYclmm/v+56ugT4rEBMWSb+qtJtuq5JVwCfZ5ak9Nqv07XrEfoDT4xUwAd0RfC06jpfLeDzm95QKwLx2hjd7GbvJcAv6BizbMz4BXxbvWwmAd9WL5upB/BHvZcnMT6padGpujz4ZDtsy2BX6+rgkyNvYyF6tQR8bsGLqF3waa5ZwAfULPhUUBLjeV0e/JZdXmlq9AN+NbZrBYNmwWf/1jK9dkQCfpumD5aApxLwGU1IjN+i6aN1KWzrdT3wAjhJlwN/rUi8nwR8pxLwnepy4A/9p6Ya1gXBn9d1SxLwnUrA76a6Q871wNfywKuZgLwuCL4SCfh6tatvEPDVamc0lYScgAR8p1oL/v1eTfr8nNn0+RLwYS1b/MfDXVnTFahuZ7yv1rv6998/Ok0alY9qJ9U4prPUU4wvdu1XnDACfr96uuYpsw34Fy7OV3fLx4OvOH3sCTyyvxW/GS+rw+Kau6sr8FaZQIod9uXBlzR9pg4DcvUYX9L0marYEo9Sn+ArtsSj1Cl4kYDvVAK+Uwn4TiXgO5WA71QCvlMJ+E4l4DuVgO9UAr5T7QleVLP2A89MhYPrHV/xMh0K+E47FPCddijgO+1QwHfaoYDvtEMB32mHhC3DWwAAAvRJREFU24IXNSMB36kEfKcS8J1KwHcqAd+pBHynEvCdSsB3KgHfqTYF//ZVqe/Ztd7v1U8/jutu1MdDScWPB/XpcbmYr9tI/V8TmFDtd89lj2esGH88W4Iffi/a28+5T2Zg8PLlsO4mvRTNmKfv+rVkjg4jfcmv+DrMlpLHM1ZceDxbgn8dxveU+0Tfvz1PM/SY7ka9/csfCuoNIy3S2y8/Cio/ffrz7bEUPJ6p4sLj2TrGe78NcVHjU8muVdzdoI9f/6fE1b/98t9lrr7Q4kfgRY/HzJRIxY3Bh3//aVCD8ywFX9DdoJe7ohj/9vX7yCFfhWnMwK/o8czgY49nK/BPSn0ZbjAfxAqLL+lu6rEMfOlIh1D7WpDdrbT46OPZOKsvjJxFMb6sOz1kdoPy58z7fxSCL3Vqb2Ux3mb1scezJfgyEIM/KsrqS7lPnRZm9UWufo3FFz2e0VXEH8+W4CdLyn6ipev4wu5GlYG/jbRkOT6sr4qywlXr+IXHIzt3nUrAdyoB36kEfKcS8J1KwHcqAd+pBHynEvCdSsB3KgHfqQR8pxLwnUrAdyoB36kEfKcS8J1KwHcqAd+pBHyn6gX88A1C9Eo1vLA8/RR7gfl2rez176rVDfjxhVX7bruA7wr88FL1+Ir0+H/T14gp+OkF6uFLcsOLybej3/77X26n/va7/yz+Rnal6gr88MWGp/H7CbfD8WvExpgN+Pnq17vx2y+3o9dPj0Oh+cSF1A34r9PXCwbc79+M77Y/mWO4OkyNb8/649fHeXZczN13Ax58+fCtlvHwSQ0On4CHqwPuX34I+NZlwU+/n2Cw5/vvnquHq2LxF5HF9jRGawPz50cvxk9XxzMQ4wV8q7LYbt780+Mtv//8/KLUb//wfcI6pQBf5quG8+3on399vJX9m4DvTRfDDRLwYX08lH27uQkJ+E4l4DuVgO9UAr5TCfhOJeA7lYDvVAK+Uwn4TiXgO5WA71QCvlMJ+E4l4DuVgO9UAr5T/T99JVImINB5ngAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-51"/> </p>

<h2>Notes and further resources</h2>

<p>Notes:</p>

<ul>
<li>Bootstrapping is useful for nonlinear models</li>
<li>Care should be taken to avoid overfitting (see rfcv funtion)</li>
<li>Out of bag estimates are efficient estimates of test error</li>
</ul>

<p>Further resources:</p>

<ul>
<li><a href="http://www.stat.berkeley.edu/%7Ebreiman/RandomForests/cc_home.htm">Random forests</a></li>
<li><a href="http://en.wikipedia.org/wiki/Random_forest">Random forest Wikipedia</a></li>
<li><a href="http://en.wikipedia.org/wiki/Bootstrap_aggregating">Bagging</a></li>
<li><a href="http://stat.ethz.ch/education/semesters/FS_2008/CompStat/sk-ch8.pdf">Bagging and boosting</a></li>
</ul>

<h2>Combining predictors</h2>

<p>Key ideas</p>

<ul>
<li>You can combine classifiers by averaging/voting</li>
<li>Combining classifiers improves accuracy</li>
<li>Combining classifiers reduces interpretability</li>
</ul>

<h2>Netflix prize</h2>

<h2>Basic intuition - majority vote</h2>

<p>Suppose we have 5 completely independent classifiers</p>

<p>If accuracy is 70% for each:</p>

<ul>
<li>\( 10\cdot(0.7)^3\cdot(0.3)^2+5\cdot(0.7)^4\cdot(0.3)^1+(0.7)^5 \)</li>
<li>83.7% majority vote accuracy</li>
</ul>

<p>With 101 independent classifiers</p>

<ul>
<li>99.9% majority vote accuracy</li>
</ul>

<p>Approaches for combining classifiers</p>

<ul>
<li>Bagging (see previous lecture)</li>
<li>Boosting</li>
<li>Combining different classifiers</li>
</ul>

<h2>Example</h2>

<pre><code class="r"># library(devtools) install_github(&#39;medley&#39;,&#39;mewo2&#39;)
library(medley)
</code></pre>

<pre><code class="r">
set.seed(453234)
y &lt;- rnorm(1000)
x1 &lt;- (y &gt; 0)
x2 &lt;- y * rnorm(1000)
x3 &lt;- rnorm(1000, mean = y, sd = 1)
x4 &lt;- (y &gt; 0) &amp; (y &lt; 3)
x5 &lt;- rbinom(1000, size = 4, prob = exp(y)/(1 + exp(y)))
x6 &lt;- (y &lt; -2) | (y &gt; 2)
data &lt;- data.frame(y = y, x1 = x1, x2 = x2, x3 = x3, x4 = x4, x5 = x5, x6 = x6)
train &lt;- sample(1:1000, size = 500)
trainData &lt;- data[train, ]
testData &lt;- data[-train, ]
</code></pre>

<h2>Basic models</h2>

<pre><code class="r">library(tree)
</code></pre>

<pre><code>## Warning: package &#39;tree&#39; was built under R version 2.15.3
</code></pre>

<pre><code class="r">lm1 &lt;- lm(y ~ ., data = trainData)
rmse(predict(lm1, data = testData), testData$y)
</code></pre>

<pre><code>## [1] 1.294
</code></pre>

<pre><code class="r">tree1 &lt;- tree(y ~ ., data = trainData)
rmse(predict(tree1, data = testData), testData$y)
</code></pre>

<pre><code>## [1] 1.299
</code></pre>

<pre><code class="r">
tree2 &lt;- tree(y ~ ., data = trainData[sample(1:dim(trainData)[1]), ])
</code></pre>

<h2>Combining models</h2>

<pre><code class="r">combine1 &lt;- predict(lm1, data = testData)/2 + predict(tree1, data = testData)/2
rmse(combine1, testData$y)
</code></pre>

<pre><code>## [1] 1.281
</code></pre>

<pre><code class="r">
combine2 &lt;- (predict(lm1, data = testData)/3 + predict(tree1, data = testData)/3 + 
    predict(tree2, data = testData)/3)
rmse(combine2, testData$y)
</code></pre>

<pre><code>## [1] 1.175
</code></pre>

<h2>Medley package</h2>

<pre><code class="r"># library(devtools) install_github(&#39;medley&#39;,&#39;mewo2&#39;)
library(medley)
library(e1071)
</code></pre>

<pre><code>## Warning: package &#39;e1071&#39; was built under R version 2.15.3
</code></pre>

<pre><code class="r">library(randomForests)
</code></pre>

<pre><code>## Error: there is no package called &#39;randomForests&#39;
</code></pre>

<pre><code class="r">x &lt;- trainData[, -1]
y &lt;- trainData$y
newx &lt;- testData[, -1]
</code></pre>

<p><a href="http://www.kaggle.com/users/10748/martin-o-leary">http://www.kaggle.com/users/10748/martin-o-leary</a></p>

<h2>Blending models (part 1)</h2>

<pre><code class="r">m &lt;- create.medley(x, y, errfunc = rmse)
for (g in 1:10) {
    m &lt;- add.medley(m, svm, list(gamma = 0.001 * g))
}
</code></pre>

<pre><code>##  CV model 1 svm (gamma = 0.001) time: 0.96 error: 0.5557 
##  CV model 2 svm (gamma = 0.002) time: 0.99 error: 0.5367 
##  CV model 3 svm (gamma = 0.003) time: 0.98 error: 0.5345 
##  CV model 4 svm (gamma = 0.004) time: 0.98 error: 0.5333 
##  CV model 5 svm (gamma = 0.005) time: 1.06 error: 0.5301 
##  CV model 6 svm (gamma = 0.006) time: 0.99 error: 0.5265 
##  CV model 7 svm (gamma = 0.007) time: 1.06 error: 0.5197 
##  CV model 8 svm (gamma = 0.008) time: 1.06 error: 0.5115 
##  CV model 9 svm (gamma = 0.009) time: 1 error: 0.5026 
##  CV model 10 svm (gamma = 0.01) time: 1.06 error: 0.4946
</code></pre>

<h2>Blending models (part 2)</h2>

<pre><code class="r">for (mt in 1:2) {
    m &lt;- add.medley(m, randomForest, list(mtry = mt))
}
</code></pre>

<pre><code>##  CV model 11 randomForest (mtry = 1) time: 3.42 error: 0.4662 
##  CV model 12 randomForest (mtry = 2) time: 4.74 error: 0.4142
</code></pre>

<pre><code class="r">
m &lt;- prune.medley(m, 0.8)
rmse(predict(m, newx), testData$y)
</code></pre>

<pre><code>## Sampled... 96.00 %:  1 randomForest (mtry = 2) 
## 1.00 %:  2 randomForest (mtry = 1) 
## 1.00 %:  4 svm (gamma = 0.009) 
## 1.00 %:  5 svm (gamma = 0.008) 
## 1.00 %:  7 svm (gamma = 0.006) 
## CV error: 0.4159
</code></pre>

<pre><code>## [1] 0.4118
</code></pre>

<h2>Notes and further resources</h2>

<p>Notes:</p>

<ul>
<li>Even simple blending can be useful</li>
<li>Majority vote is typical model for binary/multiclass data</li>
<li>Makes models hard to interpret</li>
</ul>

<p>Further resources:</p>

<ul>
<li><a href="http://www.research.att.com/%7Evolinsky/bma.html">Bayesian model averaging</a></li>
<li><a href="https://www.heritagehealthprize.com/c/hhp/details/milestone-winners">Heritage health prize</a></li>
<li><a href="http://www2.research.att.com/%7Evolinsky/papers/chance.pdf">Netflix model blending</a></li>
</ul>

</body>

</html>

